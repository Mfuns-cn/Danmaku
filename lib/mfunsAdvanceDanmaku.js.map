{"version":3,"file":"mfunsAdvanceDanmaku.js","mappings":"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","sources":["webpack://mf-ade/./node_modules/css-loader/dist/runtime/api.js","webpack://mf-ade/./node_modules/css-loader/dist/runtime/cssWithMappingToString.js","webpack://mf-ade/./css/base.css","webpack://mf-ade/./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js","webpack://mf-ade/webpack/bootstrap","webpack://mf-ade/webpack/runtime/compat get default export","webpack://mf-ade/webpack/runtime/define property getters","webpack://mf-ade/webpack/runtime/hasOwnProperty shorthand","webpack://mf-ade/./css/base.css?3901","webpack://mf-ade/./src/Context/Context.ts","webpack://mf-ade/./src/i18n/zh-cn.ts","webpack://mf-ade/./src/i18n/index.ts","webpack://mf-ade/./src/core/Style/Unit/PxSize.ts","webpack://mf-ade/./src/TimeLine/AdvancedLine.ts","webpack://mf-ade/./src/Factory/TimeLineFactort.ts","webpack://mf-ade/./src/util/deepMerge.ts","webpack://mf-ade/./src/core/Animation/Base/Cubic.ts","webpack://mf-ade/./src/Event/DanmakuEventType.ts","webpack://mf-ade/./src/core/Animation/Base/CubicAnimations.ts","webpack://mf-ade/./src/core/Animation/Base/Matrix.ts","webpack://mf-ade/./src/core/Animation/CompositeAnimation/GroupAnimations.ts","webpack://mf-ade/./src/core/Animation/CompositeAnimation/ListAnimations.ts","webpack://mf-ade/./src/core/Animation/styleAnimations/OpacityAnimations.ts","webpack://mf-ade/./src/core/Animation/TransformsAnimations/StaticAnimation.ts","webpack://mf-ade/./src/core/Animation/CompositeAnimation/RepeatAnimations.ts","webpack://mf-ade/./src/core/Animation/Base/OriginAnimations.ts","webpack://mf-ade/./src/core/Animation/TransformsAnimations/ScaleAnimations.ts","webpack://mf-ade/./src/core/Animation/TransformsAnimations/TranslateAnimation.ts","webpack://mf-ade/./src/core/Animation/TransformsAnimations/RotationAnimation.ts","webpack://mf-ade/./src/core/Animation/TransformsAnimations/RotationXAnimation.ts","webpack://mf-ade/./src/core/Animation/TransformsAnimations/RotationYAnimation.ts","webpack://mf-ade/./src/core/Animation/TransformsAnimations/RotationZAnimation.ts","webpack://mf-ade/./src/Factory/AnimationFactory.ts","webpack://mf-ade/./src/core/Danmaku/BaseDanmaku.ts","webpack://mf-ade/./src/Factory/DanmakuParser/DanmakuFactory.ts","webpack://mf-ade/./src/Event/DanmakuEvent.ts","webpack://mf-ade/./src/Factory/DanmakuParser/JsonDanmakuParser.ts","webpack://mf-ade/./src/core/Renderer/BaseRenderer.ts","webpack://mf-ade/./src/util/UnitTools.ts","webpack://mf-ade/./src/core/Renderer/CSS3Renderer/CssDanmakuObj.ts","webpack://mf-ade/./src/core/Renderer/CSS3Renderer/CSS3Renderer.ts","webpack://mf-ade/./src/Factory/RendererFactory.ts","webpack://mf-ade/./src/Controller/Controller.ts","webpack://mf-ade/./src/core/Style/Unit/Color.ts","webpack://mf-ade/./src/core/Stage/BaseStage.ts","webpack://mf-ade/./src/core/Stage/TestStage.ts","webpack://mf-ade/./src/index.ts"],"sourcesContent":["\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\n// eslint-disable-next-line func-names\nmodule.exports = function (cssWithMappingToString) {\n  var list = []; // return the list of modules as css string\n\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = cssWithMappingToString(item);\n\n      if (item[2]) {\n        return \"@media \".concat(item[2], \" {\").concat(content, \"}\");\n      }\n\n      return content;\n    }).join(\"\");\n  }; // import a list of modules into the list\n  // eslint-disable-next-line func-names\n\n\n  list.i = function (modules, mediaQuery, dedupe) {\n    if (typeof modules === \"string\") {\n      // eslint-disable-next-line no-param-reassign\n      modules = [[null, modules, \"\"]];\n    }\n\n    var alreadyImportedModules = {};\n\n    if (dedupe) {\n      for (var i = 0; i < this.length; i++) {\n        // eslint-disable-next-line prefer-destructuring\n        var id = this[i][0];\n\n        if (id != null) {\n          alreadyImportedModules[id] = true;\n        }\n      }\n    }\n\n    for (var _i = 0; _i < modules.length; _i++) {\n      var item = [].concat(modules[_i]);\n\n      if (dedupe && alreadyImportedModules[item[0]]) {\n        // eslint-disable-next-line no-continue\n        continue;\n      }\n\n      if (mediaQuery) {\n        if (!item[2]) {\n          item[2] = mediaQuery;\n        } else {\n          item[2] = \"\".concat(mediaQuery, \" and \").concat(item[2]);\n        }\n      }\n\n      list.push(item);\n    }\n  };\n\n  return list;\n};","\"use strict\";\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { var _i = arr && (typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]); if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nmodule.exports = function cssWithMappingToString(item) {\n  var _item = _slicedToArray(item, 4),\n      content = _item[1],\n      cssMapping = _item[3];\n\n  if (!cssMapping) {\n    return content;\n  }\n\n  if (typeof btoa === \"function\") {\n    // eslint-disable-next-line no-undef\n    var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(cssMapping))));\n    var data = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(base64);\n    var sourceMapping = \"/*# \".concat(data, \" */\");\n    var sourceURLs = cssMapping.sources.map(function (source) {\n      return \"/*# sourceURL=\".concat(cssMapping.sourceRoot || \"\").concat(source, \" */\");\n    });\n    return [content].concat(sourceURLs).concat([sourceMapping]).join(\"\\n\");\n  }\n\n  return [content].join(\"\\n\");\n};","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../node_modules/css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".danmaku-containers{\\n    position: relative;\\n}\\n.danmaku-containers  *{\\n    box-sizing: border-box;\\n    transform-style: preserve-3d;\\n    margin: 0;\\n    padding: 0;\\n    font-size: 40px;\\n    image-rendering: pixelated; /* 小图片放大后像素不虚化 */\\n    image-rendering: -moz-crisp-edges;\\n}\\n.danmaku-containers .stage{\\n    position: absolute;\\n    overflow: hidden;\\n    perspective:1000px;\\n    transform-style: preserve-3d;\\n}\\n.danmaku-containers-debug *{\\n    outline: 1px solid red;\\n}\\n\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://./css/base.css\"],\"names\":[],\"mappings\":\"AAAA;IACI,kBAAkB;AACtB;AACA;IACI,sBAAsB;IACtB,4BAA4B;IAC5B,SAAS;IACT,UAAU;IACV,eAAe;IACf,0BAA0B,EAAE,gBAAgB;IAC5C,iCAAiC;AACrC;AACA;IACI,kBAAkB;IAClB,gBAAgB;IAChB,kBAAkB;IAClB,4BAA4B;AAChC;AACA;IACI,sBAAsB;AAC1B\",\"sourcesContent\":[\".danmaku-containers{\\n    position: relative;\\n}\\n.danmaku-containers  *{\\n    box-sizing: border-box;\\n    transform-style: preserve-3d;\\n    margin: 0;\\n    padding: 0;\\n    font-size: 40px;\\n    image-rendering: pixelated; /* 小图片放大后像素不虚化 */\\n    image-rendering: -moz-crisp-edges;\\n}\\n.danmaku-containers .stage{\\n    position: absolute;\\n    overflow: hidden;\\n    perspective:1000px;\\n    transform-style: preserve-3d;\\n}\\n.danmaku-containers-debug *{\\n    outline: 1px solid red;\\n}\\n\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","\"use strict\";\n\nvar isOldIE = function isOldIE() {\n  var memo;\n  return function memorize() {\n    if (typeof memo === 'undefined') {\n      // Test for IE <= 9 as proposed by Browserhacks\n      // @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n      // Tests for existence of standard globals is to allow style-loader\n      // to operate correctly into non-standard environments\n      // @see https://github.com/webpack-contrib/style-loader/issues/177\n      memo = Boolean(window && document && document.all && !window.atob);\n    }\n\n    return memo;\n  };\n}();\n\nvar getTarget = function getTarget() {\n  var memo = {};\n  return function memorize(target) {\n    if (typeof memo[target] === 'undefined') {\n      var styleTarget = document.querySelector(target); // Special case to return head of iframe instead of iframe itself\n\n      if (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n        try {\n          // This will throw an exception if access to iframe is blocked\n          // due to cross-origin restrictions\n          styleTarget = styleTarget.contentDocument.head;\n        } catch (e) {\n          // istanbul ignore next\n          styleTarget = null;\n        }\n      }\n\n      memo[target] = styleTarget;\n    }\n\n    return memo[target];\n  };\n}();\n\nvar stylesInDom = [];\n\nfunction getIndexByIdentifier(identifier) {\n  var result = -1;\n\n  for (var i = 0; i < stylesInDom.length; i++) {\n    if (stylesInDom[i].identifier === identifier) {\n      result = i;\n      break;\n    }\n  }\n\n  return result;\n}\n\nfunction modulesToDom(list, options) {\n  var idCountMap = {};\n  var identifiers = [];\n\n  for (var i = 0; i < list.length; i++) {\n    var item = list[i];\n    var id = options.base ? item[0] + options.base : item[0];\n    var count = idCountMap[id] || 0;\n    var identifier = \"\".concat(id, \" \").concat(count);\n    idCountMap[id] = count + 1;\n    var index = getIndexByIdentifier(identifier);\n    var obj = {\n      css: item[1],\n      media: item[2],\n      sourceMap: item[3]\n    };\n\n    if (index !== -1) {\n      stylesInDom[index].references++;\n      stylesInDom[index].updater(obj);\n    } else {\n      stylesInDom.push({\n        identifier: identifier,\n        updater: addStyle(obj, options),\n        references: 1\n      });\n    }\n\n    identifiers.push(identifier);\n  }\n\n  return identifiers;\n}\n\nfunction insertStyleElement(options) {\n  var style = document.createElement('style');\n  var attributes = options.attributes || {};\n\n  if (typeof attributes.nonce === 'undefined') {\n    var nonce = typeof __webpack_nonce__ !== 'undefined' ? __webpack_nonce__ : null;\n\n    if (nonce) {\n      attributes.nonce = nonce;\n    }\n  }\n\n  Object.keys(attributes).forEach(function (key) {\n    style.setAttribute(key, attributes[key]);\n  });\n\n  if (typeof options.insert === 'function') {\n    options.insert(style);\n  } else {\n    var target = getTarget(options.insert || 'head');\n\n    if (!target) {\n      throw new Error(\"Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.\");\n    }\n\n    target.appendChild(style);\n  }\n\n  return style;\n}\n\nfunction removeStyleElement(style) {\n  // istanbul ignore if\n  if (style.parentNode === null) {\n    return false;\n  }\n\n  style.parentNode.removeChild(style);\n}\n/* istanbul ignore next  */\n\n\nvar replaceText = function replaceText() {\n  var textStore = [];\n  return function replace(index, replacement) {\n    textStore[index] = replacement;\n    return textStore.filter(Boolean).join('\\n');\n  };\n}();\n\nfunction applyToSingletonTag(style, index, remove, obj) {\n  var css = remove ? '' : obj.media ? \"@media \".concat(obj.media, \" {\").concat(obj.css, \"}\") : obj.css; // For old IE\n\n  /* istanbul ignore if  */\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = replaceText(index, css);\n  } else {\n    var cssNode = document.createTextNode(css);\n    var childNodes = style.childNodes;\n\n    if (childNodes[index]) {\n      style.removeChild(childNodes[index]);\n    }\n\n    if (childNodes.length) {\n      style.insertBefore(cssNode, childNodes[index]);\n    } else {\n      style.appendChild(cssNode);\n    }\n  }\n}\n\nfunction applyToTag(style, options, obj) {\n  var css = obj.css;\n  var media = obj.media;\n  var sourceMap = obj.sourceMap;\n\n  if (media) {\n    style.setAttribute('media', media);\n  } else {\n    style.removeAttribute('media');\n  }\n\n  if (sourceMap && typeof btoa !== 'undefined') {\n    css += \"\\n/*# sourceMappingURL=data:application/json;base64,\".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))), \" */\");\n  } // For old IE\n\n  /* istanbul ignore if  */\n\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    while (style.firstChild) {\n      style.removeChild(style.firstChild);\n    }\n\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nvar singleton = null;\nvar singletonCounter = 0;\n\nfunction addStyle(obj, options) {\n  var style;\n  var update;\n  var remove;\n\n  if (options.singleton) {\n    var styleIndex = singletonCounter++;\n    style = singleton || (singleton = insertStyleElement(options));\n    update = applyToSingletonTag.bind(null, style, styleIndex, false);\n    remove = applyToSingletonTag.bind(null, style, styleIndex, true);\n  } else {\n    style = insertStyleElement(options);\n    update = applyToTag.bind(null, style, options);\n\n    remove = function remove() {\n      removeStyleElement(style);\n    };\n  }\n\n  update(obj);\n  return function updateStyle(newObj) {\n    if (newObj) {\n      if (newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap) {\n        return;\n      }\n\n      update(obj = newObj);\n    } else {\n      remove();\n    }\n  };\n}\n\nmodule.exports = function (list, options) {\n  options = options || {}; // Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n  // tags it will allow on a page\n\n  if (!options.singleton && typeof options.singleton !== 'boolean') {\n    options.singleton = isOldIE();\n  }\n\n  list = list || [];\n  var lastIdentifiers = modulesToDom(list, options);\n  return function update(newList) {\n    newList = newList || [];\n\n    if (Object.prototype.toString.call(newList) !== '[object Array]') {\n      return;\n    }\n\n    for (var i = 0; i < lastIdentifiers.length; i++) {\n      var identifier = lastIdentifiers[i];\n      var index = getIndexByIdentifier(identifier);\n      stylesInDom[index].references--;\n    }\n\n    var newLastIdentifiers = modulesToDom(newList, options);\n\n    for (var _i = 0; _i < lastIdentifiers.length; _i++) {\n      var _identifier = lastIdentifiers[_i];\n\n      var _index = getIndexByIdentifier(_identifier);\n\n      if (stylesInDom[_index].references === 0) {\n        stylesInDom[_index].updater();\n\n        stylesInDom.splice(_index, 1);\n      }\n    }\n\n    lastIdentifiers = newLastIdentifiers;\n  };\n};","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","import api from \"!../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../node_modules/css-loader/dist/cjs.js!./base.css\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};","/**\n * 全局上下文\n */\nexport class Context{\n    /**\n     * 当前语言\n     */\n    public static language:string = \"zh-cn\";\n    public static debug = false;\n}\n\n","export default {\n    \"Containers is null\" : \"容器为空\",\n    \"Start mount stage\" : \"开始挂载舞台\",\n    \"Renderer type is null\": \"没有找到合适的渲染器\",\n    \"matrix3d param less than 16\":\"matrix3d 参数小于16个\",\n    \"Unknown danmaku format\":\"未知的弹幕格式\",\n    \"Danmaku parser fail\":\"高级弹幕解析失败，json格式可能存在问题\"\n}","import { Context } from \"../Context/Context\";\nimport zhCn from \"./zh-cn\";\n/**\n * i18n 国际化函数\n */\nexport class I18n {\n    private static tranTxt = {\n        \"zh-cn\": zhCn\n    }\n    /**\n     * 当前语言\n     */\n    private static language: string = Context.language;\n    /**\n     * 获取翻译，如果不存在，则返回自身\n     * @param str 需要国际化的字符串\n     * @returns 翻译结果\n     */\n    public static t(str: string): string {\n        // 检查字符串是否存在\n        if (this.tranTxt[this.language] && this.tranTxt[this.language][str]) {\n            return this.tranTxt[this.language][str];\n        }\n        return str;\n    }\n}","import { UnitInterface } from \"./UnitInterface\";\n\nexport class PxSize implements UnitInterface{\n    public length:number\n    constructor(length:number){\n        this.length = length;\n    }\n    public string(): string {\n        return this.length +\"px\";\n    }\n\n}","import { DanmakuItemInterface } from \"../core/Danmaku/DanmakuItemInterface\";\nimport { TimeLineDanmaku } from \"./TimeLineDanmaku\";\nimport { TimeLineInterface } from \"./TimeLineInterface\";\n\n/**\n * 高级弹幕时间轴\n */\nexport class AdvancedLine implements TimeLineInterface {\n  /**\n   * 上次获取时间(10ms)\n   */\n  public lastTime: number = 0;\n  /**\n   * 时间轴,二维数组，一维是弹幕的开始10毫秒数，二维是此毫秒数下的弹幕集合\n   * 注意：为了节省性能，最小单位时间是10ms，\n   *       仅仅是数组下标是10ms，其余的都是按照ms计算的\n   */\n  public danmakuList: TimeLineDanmaku[][] = [];\n\n  /**\n   * 添加一个弹幕\n   * @param danmaku\n   * @param start\n   * @param end\n   */\n  public addDanmaku(\n    danmaku: DanmakuItemInterface,\n    start?: number,\n    end?: number\n  ) {\n    start = start || danmaku.startTime();\n\n    end = end || danmaku.getAnimation().getDuration() + start;\n    let index = this.timeToIndex(start);\n\n    if (!this.danmakuList[index]) {\n      this.danmakuList[index] = [];\n    }\n    this.danmakuList[index].push({\n      danmaku: danmaku,\n      start: start,\n      end: end,\n    });\n  }\n  /**\n   * 时间转换\n   * @param time\n   * @returns\n   */\n  protected timeToIndex(time: number): number {\n    return Math.floor(time / 16);\n  }\n  public getDanmakuList(time: number): {\n    skip: boolean;\n    DanmakuList: TimeLineDanmaku[];\n  } {\n    time = this.timeToIndex(time);\n    // 如果请求的时间超过了时间轴。。。\n    if (time < 0) {\n      return { skip: false, DanmakuList: [] };\n    }\n\n    let arr: TimeLineDanmaku[] = [];\n    let skip = false;\n    // 当两次时间超过200ms，表示发生了跳转\n    if (this.lastTime <= time && time - this.lastTime < 5) {\n      // 正常播放情况,遍历期间的所有内容\n      // console.log(this.lastTime);\n\n      for (let a = this.lastTime; a < time; a++) {\n        if (this.danmakuList[a]) {\n          // console.log(time);\n\n          arr.push(...this.danmakuList[a]);\n        }\n      }\n    } else {\n      // 否则说明播放发生了跳转，则遍历找到合适的内容\n      // 查找范围：在当前时间之前开始的，并且结束于当前时间之后的，\n      // 先找到之前开始的\n\n      for (let timeIndex = 0; timeIndex < time; timeIndex++) {\n        if (!this.danmakuList[timeIndex]) {\n          continue; // 当前时间不存在\n        }\n        // 接着再查找当前时间之后结束的\n        for (let l = 0; l < this.danmakuList[timeIndex].length; l++) {\n          if (\n            this.danmakuList[timeIndex][l] &&\n            this.timeToIndex(this.danmakuList[timeIndex][l].end) > time\n          ) {\n            arr.push(this.danmakuList[timeIndex][l]);\n          }\n        }\n      }\n      skip = true;\n    }\n    this.lastTime = time;\n\n    return { skip: skip, DanmakuList: arr };\n  }\n  public reset(): boolean {\n    this.danmakuList = [];\n    return true;\n  }\n}\n","import { AdvancedLine } from \"../TimeLine/AdvancedLine\";\nimport { TimeLineInterface } from \"../TimeLine/TimeLineInterface\";\n\nexport class TimeLineFactory{\n    public static list = {\n        \"defult\":AdvancedLine,\n        \"advance\":AdvancedLine\n    }\n    public static getTimeLine(type:string):TimeLineInterface{\n        if(!this.list[type]){\n           type = \"default\"\n        }\n        return new this.list[type]()\n    }\n}","/**\n * 对象深度合并\n * @param obj1\n * @param obj2\n * @returns\n */\nexport function deepMerge(obj1, obj2) {\n  let key;\n  // tslint:disable-next-line: forin\n  for (key in obj2) {\n    obj1[key] =\n      obj1[key] &&\n      obj1[key].toString() === \"[object Object]\" &&\n      obj2[key] &&\n      obj2[key].toString() === \"[object Object]\"\n        ? deepMerge(obj1[key], obj2[key])\n        : (obj1[key] = obj2[key]);\n  }\n  return obj1;\n}\n","/**\n * 贝塞尔相关工具函数\n */\nexport class Cubic {\n    public px3: number\n    public px2: number\n    public px1: number\n    public py3: number\n    public py2: number\n    public py1: number\n    public epsilon: number\n    constructor (a: number, b: number, c: number, d: number) {\n      this.px3 = 3 * a\n      this.px2 = 3 * (c - a) - this.px3\n      this.px1 = 1 - this.px3 - this.px2\n      this.py3 = 3 * b\n      this.py2 = 3 * (d - b) - this.py3\n      this.py1 = 1 - this.py3 - this.py2\n      this.epsilon = 1e-7      // 目标精度\n    }\n\n    public getX(t: number) {\n      return ((this.px1 * t + this.px2) * t + this.px3) * t\n    }\n\n    public getY(t: number) {\n      return ((this.py1 * t + this.py2) * t + this.py3) * t\n    }\n\n    public solve(x: number) {\n      if (x === 0 || x === 1) {             // 对 0 和 1 两个特殊 t 不做计算\n        return this.getY(x)\n      }\n      let t = x\n      for (let i = 0; i < 8; i++) {         // 进行 8 次迭代\n        let g = this.getX(t) - x\n        if (Math.abs(g) < this.epsilon) {   // 检测误差到可以接受的范围\n          return this.getY(t)\n        }\n        let d = (3 * this.px1 * t + 2 * this.px2) * t + this.px3   // 对 x 求导\n        if (Math.abs(d) < 1e-6) {           // 如果梯度过低，说明牛顿迭代法无法达到更高精度\n          break\n        }\n        t = t - g / d\n      }\n      return this.getY(t)                   // 对得到的近似 t 求 y\n    }\n  }\n","/**\n * 弹幕事件类型枚举\n */\nexport enum DanmakuEventType {\n  /**\n   * 弹幕字符串无效\n   */\n  DANMAKU_JSON_INVALID = \"DANMAKU_JSON_INVALID\",\n  /**\n   * 单条弹幕格式错误\n   */\n  DANMAKU_FORMAT_ERROR = \"DANMAKU_FORMAT_ERROR\",\n\n  /**\n   * 弹幕开始加载\n   */\n  DANMAKU_LOAD_START = \"DANMAKU_LOAD_START\",\n\n  /**\n   * 弹幕加载完成\n   */\n  DANMAKU_LOAD_DONE = \"DANMAKU_LOAD_DONE\",\n\n  /**\n   * 弹幕舞台重置\n   */\n  DANMAKU_STAGE_RESET = \"DANMAKU_STAGE_RESET\"\n}\n","import { DanmakuStyle } from \"../../Style/DanmakuStyle\";\nimport { AnimationInterface } from \"./AnimationInterface\";\nimport { Cubic } from \"./Cubic\";\n\n/**\n * 贝塞尔动画类\n */\nexport abstract class CubicAnimations implements AnimationInterface {\n\n    /**\n     * 贝塞尔函数\n     */\n    public cubicFunc: Cubic;\n    /**\n     * 贝塞尔参数\n     */\n    public cubic: [number, number, number, number] = [0, 0, 1, 1]\n    /**\n     * 动画总时间\n     */\n    public duration: number = 1000\n    // currentTime:number = 0\n    public getMatrix(time: number): false | number[] {\n        if (this.isEnd(time)) { return false }\n        let p = this.getProgress(time)\n        let a = this.getMatrixForCubic(p, this.duration * p)\n        return a\n    }\n    public getStyle(time: number): false | DanmakuStyle {\n        if (this.isEnd(time)) { return false }\n        let p = this.getProgress(time)\n        return this.getCubicStyle(p, this.duration * p)\n    }\n    public setParams(param?: { [idx: string]: any; }): boolean {\n        this.cubic = param?.cubic ? param?.cubic : this.cubic\n        this.duration = param?.duration ? param?.duration : this.duration\n        // console.log(param?.duration);\n        return true\n    }\n    public getDuration(): number {\n\n        return this.duration;\n    }\n    /**\n     * 根据动画时间获取动画进度\n     * @param time 动画时间\n     * @returns \n     */\n    public getProgress(time: number): number {\n        // 计算当前动画进度\n        let progress: number = time / this.duration\n        // 计算出实际动画进度\n        let a = this.getCubic().solve(progress)\n        return a;\n    }\n    /**\n     * 根据进度返回区间内的值\n     * @param start \n     * @param end \n     * @param progress \n     */\n    public getProgressValue(start: number, end: number, progress: number): number {\n        return start + (end - start) * progress\n    }\n    /**\n     * 判断动画是否结束\n     */\n    protected isEnd(time: number) {\n        return time > this.duration\n    }\n    /**\n     * 获取贝塞尔函数\n     * @returns \n     */\n    public getCubic(): Cubic {\n        if (!this.cubicFunc) {\n            this.cubicFunc = new Cubic(...this.cubic)\n        }\n        return this.cubicFunc;\n    }\n    /**\n     * 计算贝塞尔样式\n     * 注意：此处返回false仅表示未设置动画，请不要在此函数实现中判断动画结束\n     * @param progress 动画进度，0-1 有可能会超过此范围\n     */\n    public abstract getCubicStyle(progress: number, time: number): DanmakuStyle | false\n    /**\n     * 计算贝塞尔的矩阵\n     * 注意：此处返回false仅表示未设置动画，请不要在此函数实现中判断动画结束\n     * @param progress 动画进度，0-1 有可能会超过此范围\n     * @\n     */\n    public abstract getMatrixForCubic(progress: number, time: number): number[] | false\n\n}","/**\n * 矩阵变换相关工具函数\n */\nexport class Matrix {\n    /**\n     * 加法\n     * @param a \n     * @param b \n     */\n    public static add(a: number[], b: number[]): number[] {\n        let c: number[] = []\n        for (let i = 0; i < a.length; i++) {\n            c[i] = a[i] + b[i]\n        }\n        return c\n    }\n    /**\n     * 减法\n     * @param a \n     * @param b \n     * @returns \n     */\n    public static sub(a: number[], b: number[]): number[] {\n        let c: number[] = []\n        for (let i = 0; i < a.length; i++) {\n            c[i] = a[i] - b[i]\n        }\n        return c\n    }\n    public static mult(a: number[], b: number[]): number[] {\n        let a1 = this.tran(a);\n        let b1 = this.tran(b);\n         // 相乘约束\n        if (a1[0].length !== b1.length) {\n            throw new Error();\n        }\n        let m = a1.length;\n        let p = a1[0].length;\n        let n = b1[0].length;\n\n        // 初始化 m*n 全 0 二维数组\n        let c = new Array(m).fill(0).map(()=> new Array(n).fill(0));\n\n        for (let i = 0; i < m; i++) {\n            for (let j = 0; j < n; j++) {\n                for (let k = 0; k < p; k++) {\n                    c[i][j] += a1[i][k] * b1[k][j];\n                }\n            }\n        }\n\n        return [...c[0],...c[1],...c[2],...c[3]];\n    }\n    /**\n     * 将一维16位数组转换成4*4二维数组\n     * @param a \n     */\n    protected static tran(a: number[]):number[][] {\n        let arr: number[][] = []\n        for (let i = 0; i < 4; i++) {\n            for (let j = 0; j < 4; j++) {\n                let index = i * 4 + j\n                if(!arr[i]) { arr[i] = []; }\n                arr[i][j] = a[index];\n            }\n        }\n        return arr;\n    }\n    /**\n     * 获得一个无效果的4x4矩阵\n     */\n    public static getNullMatrix():number[]{\n        return [\n            1,0,0,0,\n            0,1,0,0,\n            0,0,1,0,\n            0,0,0,1\n        ]\n    }\n}","import { deepMerge } from \"../../../util/deepMerge\";\nimport { AnimationFactory } from \"../../../Factory/AnimationFactory\";\nimport { DanmakuStyle } from \"../../Style/DanmakuStyle\";\nimport { AnimationInterface } from \"../Base/AnimationInterface\";\nimport { CubicAnimations } from \"../Base/CubicAnimations\";\nimport { Matrix } from \"../Base/Matrix\";\n\n/**\n * 动画组，用于多个动画并行播放\n */\nexport class GroupAnimations extends CubicAnimations {\n  public animations: AnimationInterface[] = [];\n  /**\n   * 每个动画结束的累计矩阵\n   */\n  public cumulativeMatrix: number[][] = [];\n  public duration: number = 0;\n  public setParams(param: { [idx: string]: any }): boolean {\n    super.setParams(param);\n\n    this.animations = AnimationFactory.getAnimationsList(\n      param?.animations || []\n    );\n    // 计算出最大的动画时长\n    this.animations.forEach((val, key) => {\n      let dur = val.getDuration();\n      // 计算最后一帧\n      this.cumulativeMatrix[key] = val.getMatrix(dur) || Matrix.getNullMatrix();\n      if (dur > this.duration) {\n        // 这里覆盖了父类的属性\n        // 实际上，只有父类的时长不够，才会被更新\n        this.duration = val.getDuration();\n      }\n    });\n\n    return true;\n  }\n  public getCubicStyle(_progress: number, time: number): false | DanmakuStyle {\n    /**\n     * 合并样式，由于样式的特殊性，如果存在冲突的样式，后面的会覆盖前面的\n     */\n    let style: DanmakuStyle = { boxStyle: {}, fontStyle: {} };\n    let noneStyle = true;\n    for (const animation of this.animations) {\n      let style2 = animation.getStyle(time);\n      if (style2) {\n        noneStyle = false;\n        style = deepMerge(style, style2);\n      }\n    }\n    // for(let i = 0;i<this.animations.length;i++){\n    //     let style2 = this.animations[i].getStyle(time)\n    //     if(style2){\n    //         noneStyle = false;\n    //         style = dseepMerge(style,style2);\n    //     }\n\n    // }\n    if (noneStyle) {\n      return false;\n    }\n    return style;\n  }\n  public getMatrixForCubic(_progress: number, time: number): false | number[] {\n    // 建立一个空白矩阵\n    let arr: number[] = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\n    // 倒着计算所有的矩阵\n    for (let i = this.animations.length - 1; i >= 0; i--) {\n      let matrix = this.animations[i].getMatrix(time);\n      // console.log(matrix);\n\n      if (matrix) {\n        arr = Matrix.mult(arr, matrix);\n      } else {\n        arr = Matrix.mult(arr, this.cumulativeMatrix[i]);\n      }\n    }\n\n    return arr;\n  }\n}\n","import { AnimationFactory } from \"../../../Factory/AnimationFactory\";\nimport { DanmakuStyle } from \"../../Style/DanmakuStyle\";\nimport { AnimationInterface } from \"../Base/AnimationInterface\";\nimport { CubicAnimations } from \"../Base/CubicAnimations\";\nimport { Matrix } from \"../Base/Matrix\";\n/**\n * 动画列表组，所有动画按顺序播放\n */\nexport class ListAnimations extends CubicAnimations {\n  public animations: AnimationInterface[] = [];\n  /**\n   * 每个动画结束的累计矩阵\n   */\n  public cumulativeMatrix: number[][] = [];\n  public cumulativeTime: number[] = [];\n  public duration: number = 0;\n  public setParams(param: { [idx: string]: any }): boolean {\n    super.setParams(param);\n    this.animations = AnimationFactory.getAnimationsList(\n      param?.animations || []\n    );\n\n    let duration = 0;\n    this.cumulativeMatrix[0] = Matrix.getNullMatrix();\n    this.cumulativeTime[0] = duration;\n\n    this.animations.forEach((val, key) => {\n      let dur = val.getDuration();\n\n      // 自增1，因为0的结束帧的1的开头\n      key++;\n      // 计算出每个动画结束后的矩阵叠加,传入持续时间以获得最后一帧动画\n      let matrix = val.getMatrix(dur) || Matrix.getNullMatrix();\n      // 叠加\n      this.cumulativeMatrix[key] = Matrix.mult(\n        matrix,\n        this.cumulativeMatrix[key - 1]\n      );\n\n      duration += dur;\n      this.cumulativeTime[key] = duration;\n    });\n\n    if (this.duration < duration) {\n      this.duration = duration;\n    }\n\n    return true;\n  }\n\n  public getCubicStyle(_progress: number, time: number): false | DanmakuStyle {\n    let curAnimation = this.getCurAnimation(time);\n\n    if (curAnimation) {\n      return curAnimation.animation.getStyle(time);\n    }\n    return false;\n  }\n\n  public getMatrixForCubic(_progress: number, time: number): false | number[] {\n    let curAnimation = this.getCurAnimation(time);\n\n    if (curAnimation) {\n      time = time - this.cumulativeTime[curAnimation.key];\n\n      let mat =\n        curAnimation.animation.getMatrix(time) || Matrix.getNullMatrix();\n      return Matrix.mult(mat, this.cumulativeMatrix[curAnimation.key]);\n    }\n    return false;\n  }\n  /**\n   * 获取当前的动画元素,如果不存在则返回false\n   */\n  protected getCurAnimation(\n    time: number\n  ): { key: number; animation: AnimationInterface } | false {\n    for (let i = this.animations.length - 1; i >= 0; i--) {\n      let duration = this.cumulativeTime[i];\n      if (time > duration) {\n        return { key: i, animation: this.animations[i] };\n      }\n    }\n    return false;\n  }\n}\n","import { DanmakuStyle } from \"../../Style/DanmakuStyle\";\nimport { CubicAnimations } from \"../Base/CubicAnimations\";\n\n/**\n * 透明度动画\n *\n * @export\n * @class OpacityAnimations\n * @extends {CubicAnimations}\n */\nexport class OpacityAnimations extends CubicAnimations{\n    public opacity:[number,number] = [0,1]\n    public setParams(param?: { [idx: string]: any; }):boolean{\n        super.setParams(param);\n        this.opacity = param?.opacity || this.opacity\n        return true\n    }\n    public getCubicStyle(progress: number, _time: number): false | DanmakuStyle {\n        return {\n            opacity:this.getProgressValue(this.opacity[0],this.opacity[1],progress)\n        }\n    }\n    public getMatrixForCubic(_progress: number, _time: number): false | number[] {\n        return false\n    }\n\n}","import { DanmakuStyle } from \"../../Style/DanmakuStyle\";\nimport { AnimationInterface } from \"../Base/AnimationInterface\";\n\n/**\n * 静止动画 仅仅悬停在某一个位置一定时间\n */\nexport class StaticAnimation implements AnimationInterface {\n    public getDuration(): number {\n        return this.duration;\n    }\n\n    public duration: number = 1000;\n    public x: number = 0;\n    public y: number = 0;\n    public z: number = 0;\n    public setParams(param: { [idx: string]: any; }): boolean {\n        let def = 0;\n        this.duration = param?.duration || this.duration\n        this.x = param?.x || def\n        this.y = param?.y || def\n        this.z = param?.z || def\n        return true\n    }\n    public getMatrix(time: number): false | number[] {\n        // console.log(time);\n\n        if (time > this.duration) { return false; }\n\n        return [\n            1, 0, 0, 0,\n            0, 1, 0, 0,\n            0, 0, 1, 0,\n            this.x, this.y, this.z, 1\n        ]\n\n    }\n    public getStyle(): false | DanmakuStyle {\n        return false\n    }\n\n}","import { AnimationFactory } from \"../../../Factory/AnimationFactory\";\nimport { DanmakuStyle } from \"../../Style/DanmakuStyle\";\nimport { AnimationInterface } from \"../Base/AnimationInterface\";\nimport { CubicAnimations } from \"../Base/CubicAnimations\";\nimport { StaticAnimation } from \"../TransformsAnimations/StaticAnimation\";\n\nexport class RepeatAnimations extends CubicAnimations{\n    /**\n     * 动画接口\n     */\n    public animation:AnimationInterface\n    /**\n     * 重复次数\n     */\n    public repeat:number = 1\n    /**\n     * 单个动画时间\n     */\n    public animationTime:number;\n    public duration:number = 0;\n    public getCubicStyle(_progress: number, time: number): false | DanmakuStyle {\n        return this.animation.getStyle(this.getCurTime(time))\n    }\n    public getMatrixForCubic(_progress: number, time: number): false | number[] {\n        return this.animation.getMatrix(this.getCurTime(time))\n    }\n    public setParams(param: { [idx: string]: any; }): boolean {\n        super.setParams(param);\n\n        if(param?.animation){\n            this.animation =  AnimationFactory.getAnimations(param?.animation.type,param?.animation.params) || new StaticAnimation()\n\n        }else{\n            this.animation = new StaticAnimation()\n        }\n\n        console.log(this.animation);\n\n        this.repeat = param?.repeat || this.repeat\n        this.animationTime = this.animation.getDuration()\n        // 覆盖父级存活时间 \n        // 计算方式 单个弹幕时间 X 弹幕重复次数\n        this.duration = this.animationTime * this.repeat\n        console.log(this.duration);\n\n        return true\n    }\n    /**\n     * 获得当前的弹幕时间\n     */\n    public getCurTime(time:number){\n        // 取余\n        return time % this.animationTime\n    }\n}","import { CubicAnimations } from \"./CubicAnimations\";\nimport { Matrix } from \"./Matrix\";\n\n/**\n * 可改变动画中心点的动画\n *\n * @export\n * @abstract\n * @class OriginAnimations\n * @extends {CubicAnimations}\n */\nexport abstract class OriginAnimations extends CubicAnimations {\n    public origin:number[] = [0,0,0]\n    public setParams(param: { [idx: string]: any; }): boolean {\n        if (!super.setParams(param)) { return false; }\n        this.origin =  param?.origin || this.origin\n        return true\n    }\n    public getMatrixForCubic(progress: number): number[] | false{\n        let arr = this.getMatrixForOrigin(progress)\n        if(!arr) { return false }\n        arr = Matrix.mult([\n            1, 0, 0, 0,\n            0, 1, 0, 0,\n            0, 0, 1, 0,\n            -this.origin[0], -this.origin[1], -this.origin[2], 1\n\n        ],                arr)\n        return Matrix.mult(arr,[\n            1, 0, 0, 0,\n            0, 1, 0, 0,\n            0, 0, 1, 0,\n            this.origin[0], this.origin[1], this.origin[2], 1\n\n        ])\n    }\n    /**\n     * 获取用于计算原坐标点的矩阵\n     * @param progress \n     */\n    public abstract getMatrixForOrigin(progress: number): number[] | false\n}","import { DanmakuStyle } from \"../../Style/DanmakuStyle\";\nimport { OriginAnimations } from \"../Base/OriginAnimations\";\n\n/**\n * 缩放动画\n */\nexport class ScaleAnimations extends OriginAnimations{\n    public scale:{x1:number,y1:number,z1:number,x2:number,y2:number,z2:number}\n    = {x1:1,y1:1,z1:1,x2:1,y2:1,z2:1}\n    public setParams(param: { [idx: string]: any; }): boolean {\n        if (!super.setParams(param)) { return false; }\n        this.scale = Object.assign(this.scale,param?.scale)\n        return true\n    }\n    public getMatrixForOrigin(progress: number): false | number[] {\n        let x = this.getProgressValue(this.scale.x1, this.scale.x2, progress);\n        let y = this.getProgressValue(this.scale.y1, this.scale.y2, progress)\n        let z = this.getProgressValue(this.scale.z1, this.scale.z2, progress)\n        let m = [\n            x,0,0,0,\n            0,y,0,0,\n            0,0,z,0,\n            0,0,0,1\n        ]\n        return m\n\n    }\n    public getCubicStyle(_progress: number): false | DanmakuStyle {\n       return false\n    }\n\n}","import { DanmakuStyle } from \"../../Style/DanmakuStyle\";\nimport { CubicAnimations } from \"../Base/CubicAnimations\";\n\nexport class TranslateAnimation extends CubicAnimations {\n\n    public path: { x1: number, y1: number, z1: number, x2: number, y2: number, z2: number }\n        =\n        { x1: 0, y1: 0, x2: 0, y2: 0, z1: 0, z2: 0 }\n    public setParams(param: { [idx: string]: any; }): boolean {\n        if (!super.setParams(param)) { return false; }\n        this.path = Object.assign(this.path,param?.path)\n        return true\n    }\n    public getCubicStyle(): false | DanmakuStyle {\n        return false;\n    }\n    public getMatrixForCubic(progress: number): false | number[] {\n        // console.log(this.path);\n        // console.log(progress);\n\n        let x = this.getProgressValue(this.path.x1, this.path.x2, progress);\n        let y = this.getProgressValue(this.path.y1, this.path.y2, progress)\n        let z = this.getProgressValue(this.path.z1, this.path.z2, progress)\n\n        return [\n            1, 0, 0, 0,\n            0, 1, 0, 0,\n            0, 0, 1, 0,\n            x, y, z, 1\n        ]\n    }\n}","import { DanmakuStyle } from \"../../Style/DanmakuStyle\";\nimport { OriginAnimations } from \"../Base/OriginAnimations\";\n\n/**\n * 旋转父类\n */\nexport abstract class RotationAnimation extends OriginAnimations {\n\n    public angle:{start:number,end:number} = {start:0,end:360}\n    public setParams(param: { [idx: string]: any; }): boolean {\n        if (!super.setParams(param)) { return false; }\n        this.angle = Object.assign(this.angle,param?.angle)\n        return true\n    }\n    public getCubicStyle(_progress: number): false | DanmakuStyle {\n        return false;\n    }\n    /**\n     * 角度转弧度\n     */\n    protected A2R(a: number) {\n        return a * (Math.PI / 180)\n    }\n}","import { RotationAnimation } from \"./RotationAnimation\";\n\n/**\n * X轴旋转\n */\nexport class RotationXAnimation extends RotationAnimation {\n    public getMatrixForOrigin(progress: number): false | number[] {\n        let angle = this.getProgressValue(this.angle.start,this.angle.end,progress)\n        let sin = Math.sin(this.A2R(angle));\n        let cos = Math.cos(this.A2R(angle))\n        return [\n            1, 0, 0, 0,\n            0, cos, sin, 0,\n            0, -sin, cos, 0,\n            0, 0, 0, 1\n        ]\n    }\n}","import { RotationAnimation } from \"./RotationAnimation\";\n/**\n * y轴旋转\n */\nexport class RotationYAnimation extends RotationAnimation {\n    public getMatrixForOrigin(progress: number): false | number[] {\n        let angle = this.getProgressValue(this.angle.start,this.angle.end,progress)\n        let sin = Math.sin(this.A2R(angle));\n        let cos = Math.cos(this.A2R(angle))\n        return [\n            cos, 0, sin, 0,\n            0, 1, 0, 0,\n            -sin, 0, cos, 0,\n            0, 0, 0, 1\n        ]\n    }\n}","import { RotationAnimation } from \"./RotationAnimation\";\n\n/**\n * z轴旋转\n */\nexport class RotationZAnimation extends RotationAnimation {\n    public getMatrixForOrigin(progress: number): false | number[] {\n        let angle = this.getProgressValue(this.angle.start,this.angle.end,progress)\n        let sin = Math.sin(this.A2R(angle));\n        let cos = Math.cos(this.A2R(angle))\n        return [\n            cos,sin, 0, 0,\n            -sin, cos, 0, 0,\n            0, 0,1, 0,\n            0, 0, 0, 1\n        ]\n    }\n}","import { AnimationInterface } from \"../core/Animation/Base/AnimationInterface\";\nimport { GroupAnimations } from \"../core/Animation/CompositeAnimation/GroupAnimations\";\nimport { ListAnimations } from \"../core/Animation/CompositeAnimation/ListAnimations\";\nimport { OpacityAnimations } from \"../core/Animation/styleAnimations/OpacityAnimations\";\nimport { RepeatAnimations } from \"../core/Animation/CompositeAnimation/RepeatAnimations\";\nimport { ScaleAnimations } from \"../core/Animation/TransformsAnimations/ScaleAnimations\";\nimport { TranslateAnimation } from \"../core/Animation/TransformsAnimations/TranslateAnimation\";\nimport { RotationXAnimation } from \"../core/Animation/TransformsAnimations/RotationXAnimation\";\nimport { RotationYAnimation } from \"../core/Animation/TransformsAnimations/RotationYAnimation\";\nimport { RotationZAnimation } from \"../core/Animation/TransformsAnimations/RotationZAnimation\";\nimport { StaticAnimation } from \"../core/Animation/TransformsAnimations/StaticAnimation\";\n\nexport class AnimationFactory {\n    public static animationList = {\n        \"static\":StaticAnimation,// 静态定位\n        \"translate\":TranslateAnimation,// 平移\n        \"rotateX\":RotationXAnimation,// x轴旋转\n        \"rotateY\":RotationYAnimation,// y轴旋转\n        \"rotateZ\":RotationZAnimation,// z轴旋转\n        \"scale\":ScaleAnimations,// 缩放\n        \"list\":ListAnimations,// 动画列表\n        \"group\":GroupAnimations,// 动画组\n        \"repeat\":RepeatAnimations,// 重复动画\n        \"opacity\":OpacityAnimations\n    }\n\n    public static getAnimations(type:string,params):AnimationInterface | false{\n        if(this.animationList[type]){\n            // console.log(params);\n            let ani = new this.animationList[type]()\n            // console.log(ani);\n\n            ani.setParams(params)\n            return ani;\n        }\n        return false;\n    }\n    public static getAnimationsList(list:{key: { [idx: string]: any; }}[]):AnimationInterface[]{\n        let animationList:AnimationInterface[] = []\n\n        list?.forEach((val)=>{\n            let ani =  this.getAnimations(val[\"type\"],val)\n            if(ani){\n                animationList.push(ani);\n            }\n        })\n        return animationList\n    }\n}","import { DanmakuStyle } from \"../Style/DanmakuStyle\";\nimport { AnimationInterface } from \"../Animation/Base/AnimationInterface\";\nimport { DanmakuItemInterface } from \"./DanmakuItemInterface\";\nimport { StaticAnimation } from \"../Animation/TransformsAnimations/StaticAnimation\";\n\n/**\n * 基础弹幕类型\n */\nexport class BaseDanmaku implements DanmakuItemInterface {\n  public style: DanmakuStyle = {};\n  public start: number = 0;\n  public animation?: AnimationInterface;\n  public content: string = \"\";\n  public child: DanmakuItemInterface[] = [];\n  /**\n   * 设置参数\n   * @param param\n   * @returns\n   */\n  public setParams(param: { [idx: string]: any }): boolean {\n    // 设置文字样式\n    try {\n      // 设置开始时间\n      if (param?.start) {\n        this.start = param?.start;\n      }\n      if (param?.animation) {\n        this.animation = param?.animation || new StaticAnimation();}\n      if (param?.child) { this.child = param.child; }\n      if (param?.style) { this.style = param?.style; }\n      if (param?.content) { this.content = param?.content;}\n    } catch (e) {\n      console.warn(e);\n      return false;\n    }\n\n    return true;\n  }\n  public getType(): string {\n    return \"base\";\n  }\n  public getContent(): string {\n    return this.content;\n  }\n  public getChild(): DanmakuItemInterface[] {\n    return this.child;\n  }\n  public getAnimation(): AnimationInterface {\n    if (!this.animation) {\n      this.animation = new StaticAnimation();\n    }\n    return this.animation;\n  }\n  public getStyle(): DanmakuStyle {\n    return this.style;\n  }\n  public startTime(): number {\n    return this.start;\n  }\n}\n","import { BaseDanmaku } from \"../../core/Danmaku/BaseDanmaku\";\nimport { DanmakuItemInterface } from \"../../core/Danmaku/DanmakuItemInterface\";\n\n/**\n * 弹幕解析器工厂\n */\nexport class DanmakuFactory{\n    public static list = {\n        \"text\":BaseDanmaku\n    }\n    public static getDanmakuInstance(type:string):DanmakuItemInterface{\n        if(!this.list[type]){\n            type = \"text\"\n        }\n        return new this.list[type]()\n    }\n}","import { DanmakuEventType } from \"./DanmakuEventType\";\n\n/**\n * 弹幕事件工具\n */\nexport class DanmakuEvent {\n  // 事件前缀，防止冲突\n  public static prefix = \"_danmakuevent_\";\n\n  /**\n   * 包装事件名称字符串\n   * @param eventname 事件名称\n   * @returns\n   */\n  protected static buildPrefix(eventname: DanmakuEventType): string {\n    return this.prefix + eventname;\n  }\n  /**\n   * 监听弹幕事件\n   * @param eventname \n   * @param callback \n   */\n  public static listener<T>(eventname: DanmakuEventType, callback: (data: T) => void) {\n    // 封装浏览器提供的事件监听器\n    window.addEventListener(this.buildPrefix(eventname), (data: any) => {\n      callback(data.detail);\n    });\n  }\n\n  /**\n   * 触发弹幕事件\n   * @param eventname\n   * @param data\n   */\n  public static dispatch<T>(eventname: DanmakuEventType, data: T) {\n    // 包装事件\n    let event = new CustomEvent(this.buildPrefix(eventname), {\n      detail: data,\n    });\n    // 触发事件\n    window.dispatchEvent(event);\n  }\n}\n","import { I18n } from \"../../i18n\";\nimport { DanmakuItemInterface } from \"../../core/Danmaku/DanmakuItemInterface\";\nimport { AnimationFactory } from \"../AnimationFactory\";\nimport { DanmakuFactory } from \"./DanmakuFactory\";\nimport { DanmakuParserInterface } from \"./DanmakuParserInterface\";\nimport { DanmakuEvent } from \"../../Event/DanmakuEvent\";\nimport { DanmakuEventType } from \"../../Event/DanmakuEventType\";\n\n/**\n * JSON 格式弹幕解析器\n */\nexport class JsonDanmakuParser implements DanmakuParserInterface {\n  public parser(content: string): DanmakuItemInterface[] {\n    try {\n      let json: any[] = JSON.parse(content);\n      return this.getDanmaku(json);\n    } catch (e) {\n      // 触发弹幕格式无效事件\n      DanmakuEvent.dispatch(\n        DanmakuEventType.DANMAKU_JSON_INVALID,\n        I18n.t(\"Danmaku parser fail\")\n      );\n      console.warn(I18n.t(\"Danmaku parser fail\"));\n      console.warn(e);\n      return [];\n    }\n  }\n\n  /**\n   * 获取弹幕\n   * @param obj\n   * @returns\n   */\n  public getDanmaku(obj?: any[]): DanmakuItemInterface[] {\n    let list: DanmakuItemInterface[] = [];\n\n    /**\n     * 遍历弹幕列表\n     */\n    obj?.forEach((dan, index) => {\n      /**\n       * 检测弹幕类型是否正确\n       */\n      if (typeof dan !== \"object\") {\n        console.warn(\n          `${I18n.t(\"Unknown danmaku format\")} :  ${dan}  index: + ${index}`\n        );\n        // 触发弹幕类型错误事件\n        DanmakuEvent.dispatch(DanmakuEventType.DANMAKU_FORMAT_ERROR, {\n          content: dan,\n          index,\n        });\n      } else {\n        let danmaku = DanmakuFactory.getDanmakuInstance(dan.type);\n        if (!dan?.animations || dan?.animations === []) {\n          dan.animations = [{ type: \"static\" }];\n        }\n        danmaku.setParams({\n          start: dan?.start,\n          content: dan?.content,\n          style: dan?.style,\n          animation: AnimationFactory.getAnimations(\"list\", {\n            animations: dan?.animations,\n          }), // 将列表组成一个list\n          child: this.getDanmaku(dan.childs),\n        });\n\n        list.push(danmaku);\n      }\n    });\n    return list;\n  }\n}\n","\n\nimport { DanmakuItemInterface } from \"../Danmaku/DanmakuItemInterface\";\nimport { CanvasStyle } from \"../Style/CanvasStyle\";\nimport { RendererInterface } from \"./RendererInterface\";\n\nexport class BaseRenderer implements RendererInterface {\n    public reset(): boolean {\n        throw new Error(\"Method not implemented.\");\n    }\n    public addDanmaku(_danmaku: DanmakuItemInterface): boolean {\n        return false;\n    }\n    public refresh(): boolean {\n        return false\n    }\n    protected canvas?: HTMLElement\n    public setCanvasContainer(canvas: HTMLElement): boolean {\n        this.canvas = canvas\n        return true\n    }\n    public updateCanvasStyle(style: CanvasStyle): boolean {\n        if (this.canvas) {\n            this.canvas.style.width = style.size.width.string();\n            this.canvas.style.height = style.size.height.string();\n            this.canvas.style.left = style.position.x.string()\n            this.canvas.style.top = style.position.y.string()\n            this.canvas.style.backgroundColor = style.color.string()\n            return true\n        } else {\n            return false\n        }\n    }\n}","import { I18n } from \"../i18n\";\n\nexport class UnitTools{\n    /**\n     * 拼接带单位的长度字符串\n     * @param num 长度\n     * @returns \n     */\n    public static lengthSrting(num:number):string{\n        return `${num}px`;\n    }\n    /**\n     * 拼接 Matrix3d() 字符串\n     * @param arr 16位数字\n     */\n    public static Matrix3dString(arr:number[]):string{\n        if(arr.length !== 16){\n            throw SyntaxError(I18n.t(\"matrix3d param less than 16\"));\n        }\n        return \"Matrix3d(\" + arr.join(\",\") + \")\";\n    }\n    // static UnitFactory(type:string,obj):string{\n\n    // }\n}","import { UnitTools } from \"../../../util/UnitTools\";\nimport { AnimationInterface } from \"../../Animation/Base/AnimationInterface\";\nimport { DanmakuItemInterface } from \"../../Danmaku/DanmakuItemInterface\";\nimport { DanmakuStyle } from \"../../Style/DanmakuStyle\";\n\nexport interface DanmakuObj {\n  element: HTMLElement;\n  style: DanmakuStyle;\n  animation: AnimationInterface;\n  child: DanmakuObj[];\n  start: number;\n}\nexport class DanmakuTool {\n  /**\n   * 递归构建弹幕对象\n   * @param danmaku\n   * @returns\n   */\n  public static recursionDanmaku(\n    danmaku: DanmakuItemInterface[]\n  ): DanmakuObj[] {\n    let danmakuobj: DanmakuObj[] = [];\n    danmaku.forEach((danmaku) => {\n      let div = this.createDiv(danmaku.getContent());\n      this.setStyle(div, danmaku.getStyle());\n      let obj: DanmakuObj = {\n        element: div,\n        animation: danmaku.getAnimation(),\n        style: danmaku.getStyle(),\n        child: [],\n        start: danmaku.startTime(),\n      };\n      let child = danmaku.getChild();\n      let childObj;\n      if (child) {\n        childObj = this.recursionDanmaku(child);\n      }\n\n      obj.child = childObj;\n      danmakuobj.push(obj);\n    });\n    return danmakuobj;\n  }\n  /**\n   * 创建一个空div\n   * @param content\n   * @returns\n   */\n  public static createDiv(content: string): HTMLElement {\n    let div = document.createElement(\"div\");\n    div.style.position = \"absolute\";\n    div.innerText = content;\n    return div;\n  }\n\n  /**\n   * 递归构建element\n   * @param danmakuobj\n   * @returns\n   */\n  public static recursionDiv(danmakuobj: DanmakuObj[]): HTMLElement[] {\n    let array: HTMLElement[] = [];\n    danmakuobj.forEach((item) => {\n      let element = item.element;\n      if (item.child) {\n        let eles = this.recursionDiv(item.child);\n        eles.forEach((ele) => {\n          element.appendChild(ele);\n        });\n      }\n      array.push(element);\n    });\n    return array;\n  }\n  /**\n   * 将样式设置到元素中\n   */\n  public static setStyle(element: HTMLElement, style: { [idx: string]: any }) {\n    Object.assign(element.style, style);\n  }\n  /**\n   * 递归设置弹幕动画\n   * @param danmaku\n   */\n  public static recursionStyle(\n    danmaku: DanmakuObj[],\n    canvas: HTMLElement,\n    abstime: number,\n    parentTime: number = 0\n  ) {\n    //console.log(danmaku);\n    danmaku.forEach((dan, key) => {\n      // 更新弹幕样式\n      let time =\n        parentTime === 0 ? abstime - dan.start : parentTime - dan.start;\n\n      // console.log(dan.animation);\n\n      let sty;\n      let max;\n      sty = dan.animation.getStyle(time);\n      if (sty) {\n        this.setStyle(dan.element, sty);\n      }\n      max = dan.animation.getMatrix(time);\n      if (max) {\n        dan.element.style.transform = UnitTools.Matrix3dString(max);\n      }\n      //console.log(dan);\n      // 如果都不存在，则表示动画已经完成，销毁元素\n      // 如果是子元素的情况，有可能存在弹幕未开始的情况\n      if (!(sty || max)) {\n        //console.log(dan);\n        if (dan.element.parentElement) {\n          // 从父元素删除节点\n          dan.element.parentElement.removeChild(dan.element);\n        } else {\n          // 否则从canvas里面删除\n          canvas.removeChild(dan.element);\n        }\n        // 并且清空节点\n        delete danmaku[key];\n      }\n      // 递归\n      this.recursionStyle(dan.child, canvas, abstime, time);\n    });\n  }\n}\n","import { UnitTools } from \"../../../util/UnitTools\";\nimport { DanmakuItemInterface } from \"../../Danmaku/DanmakuItemInterface\";\nimport { CanvasStyle } from \"../../Style/CanvasStyle\";\nimport { SizeInterface } from \"../../Style/SizeInterface\";\nimport { PxSize } from \"../../Style/Unit/PxSize\";\nimport { RendererInterface } from \"../RendererInterface\";\nimport { DanmakuObj, DanmakuTool } from \"./CssDanmakuObj\";\n\n\nexport class CSS3Renderer implements RendererInterface {\n\n    public canvasSize: SizeInterface = {\n        width: new PxSize(1920),\n        height: new PxSize(1080)\n    }\n    public canvas?: HTMLElement\n    public danmakuList: DanmakuObj[] = []\n    public setCanvasContainer(canvas: HTMLElement): boolean {\n        this.canvas = canvas\n        return true;\n    }\n    public updateCanvasStyle(style: CanvasStyle): boolean {\n        if (this.canvas) {\n            this.canvas.style.width = this.canvasSize.width.string();\n            this.canvas.style.height =this.canvasSize.height.string();\n            this.canvas.style.left = UnitTools.lengthSrting((style.size.width.length - this.canvasSize.width.length) / 2)\n            this.canvas.style.top = UnitTools.lengthSrting((style.size.height.length - this.canvasSize.height.length) / 2)\n            this.canvas.style.backgroundColor = style.color.string()\n            let r: number;// 缩放大小\n            if (style.size.width.length / style.size.height.length >= this.canvasSize.width.length / this.canvasSize.height.length) {\n                // 横向\n                r = style.size.height.length / this.canvasSize.height.length\n            } else {\n                // 纵向\n                r = style.size.width.length / this.canvasSize.width.length\n            }\n            this.canvas.style.transform = `scale(${r},${r})`\n\n            return true\n        } else {\n            return false\n        }\n    }\n    public addDanmaku(danmaku: DanmakuItemInterface): boolean {\n        if(!this.canvas) { return false }\n        let danmakuobj = DanmakuTool.recursionDanmaku([danmaku])\n        let eles = DanmakuTool.recursionDiv(danmakuobj)\n        eles.forEach((ele) => {\n            this.canvas?.appendChild(ele)\n        })\n        this.danmakuList.push(...danmakuobj);\n        // console.log(danmakuobj);\n\n        return true;\n    }\n\n\n\n    public refresh(time): boolean {\n        if (!this.canvas) {\n            return false;\n        }\n    \n        DanmakuTool.recursionStyle(this.danmakuList,this.canvas,time)\n        return true;\n    }\n    public reset(): boolean {\n        // 清空画布\n\n        if(this.canvas){\n            this.canvas.innerHTML = \"\";\n        }\n        // 清空数组\n        this.danmakuList = []\n        return true\n\n    }\n}\n","/**\n * 简单渲染器工厂\n */\n\nimport { I18n } from \"../i18n\";\nimport { BaseRenderer } from \"../core/Renderer/BaseRenderer\";\nimport { RendererInterface } from \"../core/Renderer/RendererInterface\";\nimport { CSS3Renderer } from \"../core/Renderer/CSS3Renderer/CSS3Renderer\";\n\nexport class RendererFactory{\n    public static rendererList = {\n        base:BaseRenderer,\n        css3:CSS3Renderer\n    }\n    public static getRenderInstance(type:string):RendererInterface{\n        if (this.rendererList[type]) {\n            return new this.rendererList[type]()\n        }else{\n            throw ReferenceError(I18n.t(\"Renderer type is null\"))\n        }\n    }\n}","import { SizeInterface } from \"../core/Style/SizeInterface\";\nimport { StageInterface } from \"../core/Stage/StageInterface\";\nimport { Context } from \"../Context/Context\";\nimport { I18n } from \"../i18n\";\nimport { CanvasStyle } from \"../core/Style/CanvasStyle\";\nimport { PxSize } from \"../core/Style/Unit/PxSize\";\nimport { TimeLineFactory } from \"../Factory/TimeLineFactort\";\nimport { JsonDanmakuParser } from \"../Factory/DanmakuParser/JsonDanmakuParser\";\nimport { DanmakuEvent } from \"../Event/DanmakuEvent\";\nimport { DanmakuEventType } from \"../Event/DanmakuEventType\";\nimport { RendererFactory } from \"../Factory/RendererFactory\";\n\n/**\n * 控制器 ，统一管理整个弹幕系统\n * 在这里，每种弹幕类型都会得到一个舞台对象，进行渲染\n */\nexport class Controller {\n  /**\n   * 画布对象\n   */\n  protected containers: HTMLElement;\n  /**\n   * 实时的Css样式表\n   */\n  protected canvasStyle: CSSStyleDeclaration;\n  /**\n   * 舞台列表\n   */\n  protected stageList: StageInterface[] = [];\n  /**\n   * 暂停状态\n   */\n  protected pauseStatus: boolean = true;\n  /**\n   * 时间戳\n   */\n  protected timeStamp: number = 0;\n  /**\n   * 播放的时间\n   */\n  protected time: number = 0;\n  /**\n   * 跳转状态\n   */\n  public skipStatus: boolean = false;\n\n  protected danmakuFunction: {\n    [type: string]: (send: (str: string[]) => void) => void;\n  } = {};\n  constructor(containers: HTMLElement) {\n    this.containers = containers;\n    // 获取实时的style对象，当大小发生变化时，会更新自身\n    this.canvasStyle = window.getComputedStyle(containers);\n    // 初始化容器\n    this.initContainer();\n    let that = this;\n    (function animloop() {\n      if (!that.pauseStatus) {\n        that.refresh();\n      }\n      requestAnimationFrame(animloop);\n    })();\n  }\n  /**\n   * 获得容器尺寸\n   */\n  public getContainersSize(): SizeInterface {\n    return {\n      width: new PxSize(parseInt(this.canvasStyle.width, 10)),\n      height: new PxSize(parseInt(this.canvasStyle.height, 10)),\n    };\n  }\n  /**\n   * 将一个舞台添加到容器内\n   * @param stage 舞台\n   * @param index 排列顺序\n   * @returns 成功与失败的状态\n   */\n  public registStage(stage: StageInterface, index: number): boolean {\n    // 检查列表中是否存在\n    if (this.stageList[index]) {\n      return false;\n    }\n    this.stageList[index] = stage;\n    return true;\n  }\n  /**\n   * 将舞台挂载到容器中\n   */\n  public mount() {\n    console.info(I18n.t(\"Start mount stage\"));\n    // 遍历每一个舞台\n    this.stageList.forEach((stage, key) => {\n      // 获取一个div\n      let div = this.getDIV();\n      // 给舞台初始化渲染器\n      let render = RendererFactory.getRenderInstance(stage.rendererType());\n      // 将div挂载到渲染器\n      render.setCanvasContainer(div);\n      // 设置舞台渲染器\n      stage.stageRenderer(render);\n      // 设置舞台时间轴\n      let lineType = stage.timeLineType();\n      let timeline = TimeLineFactory.getTimeLine(lineType);\n      stage.timeLine(timeline);\n      // 检察是否存在弹幕获取器\n      if (this.danmakuFunction[lineType]) {\n        // 如果存在，就获取弹幕\n        this.resetDanmaku(key);\n      } else {\n        console.warn(I18n.t(\"danmaku get function is null :\" + lineType));\n      }\n\n      // 更新渲染器内画布样式\n      render.updateCanvasStyle(this.getCanvasStylByStage(stage));\n    });\n  }\n\n  /**\n   * 初始化弹幕容器\n   */\n  protected initContainer() {\n    if (Context.debug) {\n      // debug模式\n      this.containers.classList.add(\"danmaku-containers-debug\");\n    }\n    this.containers.classList.add(\"danmaku-containers\");\n  }\n\n  /**\n   * 重置尺寸\n   */\n  public resize() {\n    // 重置舞台的尺寸\n    this.stageList.forEach((stage) => {\n      let render = stage.getRenderer();\n      if (render) {\n        render.updateCanvasStyle(this.getCanvasStylByStage(stage));\n      }\n    });\n  }\n\n  /**\n   * 创建div容器\n   */\n  protected getDIV(): HTMLElement {\n    let div = document.createElement(\"div\");\n    div.classList.add(\"stage\");\n    this.containers.appendChild(div);\n    return div;\n  }\n\n  /**\n   * 根据舞台对象创建一个canvasStyle\n   * @param stage 舞台对象\n   * @returns\n   */\n  protected getCanvasStylByStage(stage: StageInterface): CanvasStyle {\n    let size = stage.stageSize(this.getContainersSize());\n    let color = stage.stageBackgroundColor(this.getContainersSize());\n    let pos = stage.stagePosition(this.getContainersSize(), size);\n    return { position: pos, color: color, size: size };\n  }\n\n  public refresh() {\n    this.time = Date.now() - this.timeStamp;\n    // 通知每个舞台刷新\n    this.stageList.forEach((stage) => {\n      // console.log(1)\n      stage.refresh(this.time);\n    });\n  }\n\n  /**\n   * 暂停\n   */\n  public pause() {\n    if (!this.pauseStatus) {\n      this.pauseStatus = true;\n    }\n  }\n\n  /**\n   * 播放\n   */\n  public start() {\n    if (this.pauseStatus) {\n      // 同步时间\n      this.timeStamp = Date.now() - this.time;\n      this.pauseStatus = false;\n    }\n  }\n\n  /**\n   * 跳转\n   */\n  public skip(time: number) {\n    if (this.pauseStatus) {\n      // 如果是暂停状态\n      this.time = time;\n    } else {\n      // 否则使用这个方法\n      this.timeStamp = Date.now() - time;\n    }\n  }\n\n  /**\n   * 重置整个系统\n   */\n  public reset() {\n    // 清空所有舞台\n    this.stageList.forEach((stage) => {\n      stage.reset();\n    });\n    // 触发弹幕舞台重置事件\n    DanmakuEvent.dispatch(DanmakuEventType.DANMAKU_STAGE_RESET, {});\n\n    this.pauseStatus = true;\n    this.timeStamp = 0;\n    this.time = 0;\n    this.skipStatus = false;\n  }\n\n  /**\n   * 获取弹幕当前时间\n   * @returns number\n   */\n  public getTime(): number {\n    return this.time;\n  }\n\n  /**\n   * 添加弹幕获取器\n   * @param type\n   * @param fun\n   */\n  public addGetDanmakuFunction(\n    type: string,\n    fun: (send: (str: string[]) => void) => void\n  ) {\n    this.danmakuFunction[type] = fun;\n  }\n\n  /**\n   * 重置弹幕接口\n   */\n  public resetDanmaku(type: number) {\n    // 判断舞台列表是否存在\n    if (!this.stageList[type]) {\n      return;\n    }\n\n    // 弹幕开始加载事件\n    DanmakuEvent.dispatch(DanmakuEventType.DANMAKU_LOAD_START, {});\n    // 获取当前舞台\n    let stage = this.stageList[type];\n    // 获取弹幕时间轴\n    let timeline = stage.getTimeLine();\n    // 重置时间轴\n    timeline.reset();\n    // 根据时间轴类型找到对应的弹幕获取器\n    let fun = this.danmakuFunction[stage.timeLineType()];\n    // 判断弹幕获取器是否存在\n    if (!fun) {\n      return;\n    }\n    fun((res: string[]) => {\n      // 解析弹幕文本\n      let parser = new JsonDanmakuParser();\n      res.forEach((danmakuStr: string) => {\n        // 遍历添加进时间轴\n        parser.parser(danmakuStr).forEach((danmaku) => {\n          timeline.addDanmaku(danmaku);\n        });\n        // 弹幕加载完成事件\n        DanmakuEvent.dispatch(DanmakuEventType.DANMAKU_LOAD_DONE, {});\n      });\n    });\n  }\n}\n","import { UnitInterface } from \"./UnitInterface\"\n\n/**\n * 颜色接口\n */\n\nexport class Color implements UnitInterface {\n    public r: number\n    public g: number\n    public b: number\n    public a: number\n    constructor(r:number, g:number, b:number, a:number) {\n        this.r = r\n        this.g = g\n        this.b = b\n        this.a = a\n    }\n    public string(): string {\n        return \"rgba(\" + this.r + \",\" + this.g + \",\" + this.b + \",\" + this.a + \")\"\n    }\n    /**\n     * 常见颜色表\n     */\n    protected static color:{[key:string]:[number,number,number,number]} = {\n        \"black\":[0,0,0,1],\n        \"white\":[255,255,255,1],\n        \"red\":[255,0,0,1],\n        \"green\":[0,255,0,1],\n        \"blue\":[0,0,255,1],\n        \"pink\":[255,105,108,1],\n        \"yellow\":[255,255,0,1],\n        \"grey\":[130,130,130,1]\n    }\n    /**\n     * 获取预设颜色\n     * @param color 颜色名称\n     * @returns \n     */\n    public static getColor(color:string):Color{\n        if(this.color[color]){\n            return new this(...this.color[color])\n        }else{\n            return new this(...this.color[\"black\"])\n        }\n\n    }\n}","import { RendererInterface } from \"../Renderer/RendererInterface\";\nimport { Color } from \"../Style/Unit/Color\";\nimport { PositionInterface } from \"../Style/PositionInterface\";\nimport { SizeInterface } from \"../Style/SizeInterface\";\nimport { StageInterface } from \"./StageInterface\";\nimport { PxSize } from \"../Style/Unit/PxSize\";\nimport { TimeLineInterface } from \"../../TimeLine/TimeLineInterface\";\nimport { I18n } from \"../../i18n\";\nimport { TimeLineDanmaku } from \"../../TimeLine/TimeLineDanmaku\";\n\nexport abstract class BaseStage implements StageInterface {\n  protected renderer?: RendererInterface;\n  protected timeLineObj?: TimeLineInterface;\n  public stageSize(containersSize: SizeInterface): SizeInterface {\n    return {\n      width: containersSize.width,\n      height: containersSize.height,\n    };\n  }\n  public stagePosition(): PositionInterface {\n    return {\n      x: new PxSize(0),\n      y: new PxSize(0),\n    };\n  }\n  public stageBackgroundColor(): Color {\n    return new Color(0, 0, 0, 0);\n  }\n  public stageRenderer(render: RendererInterface): boolean {\n    this.renderer = render;\n    return true;\n  }\n  public getRenderer(): RendererInterface {\n    if (this.renderer) {\n      return this.renderer;\n    } else {\n      throw ReferenceError(I18n.t(\"renderer is null\"));\n    }\n  }\n  public timeLine(timeLine: TimeLineInterface): boolean {\n    this.timeLineObj = timeLine;\n    return true;\n  }\n  public refresh(time: number): boolean {\n    if (!this.renderer) {\n      return false;\n    }\n    // console.log(time);\n\n    let list: { skip: boolean; DanmakuList: TimeLineDanmaku[] };\n    list = this.timeLineObj?.getDanmakuList(time) || {\n      skip: false,\n      DanmakuList: [],\n    };\n    if (list) {\n      if (list.skip) {\n        this.renderer?.reset();\n      }\n\n      list.DanmakuList.forEach((val) => {\n        this.renderer?.addDanmaku(val.danmaku);\n      });\n    }\n    this.renderer.refresh(time);\n    return true;\n  }\n  public rendererType(): string {\n    return \"css3\";\n  }\n  public timeLineType(): string {\n    return \"advance\";\n  }\n\n  public reset(): boolean {\n    this?.renderer?.reset();\n    return true;\n  }\n  public getTimeLine(): TimeLineInterface {\n    if (!this.timeLineObj) {\n      throw ReferenceError(I18n.t(\"Time line is null\"));\n    }\n    return this.timeLineObj;\n  }\n}\n","\nimport { BaseStage } from \"./BaseStage\";\n\n\nexport class TestStage extends BaseStage{\n\n}","import \"../css/base.css\";\nimport { Controller } from \"./Controller/Controller\";\nimport { I18n } from \"./i18n\";\nimport { InitConfigInterface } from \"./core/InitConfigInterface\";\nimport { TestStage } from \"./core/Stage/TestStage\";\nimport { DanmakuEvent } from \"./Event/DanmakuEvent\";\nimport { DanmakuEventType } from \"./Event/DanmakuEventType\";\nexport class MFADE {\n  public controller: Controller;\n  constructor(config: InitConfigInterface) {\n    // 类型检查\n    if (!config.containers) {\n      throw ReferenceError(I18n.t(\"Containers is null\"));\n    }\n    this.controller = new Controller(config.containers);\n    this.controller.addGetDanmakuFunction(\"advance\", config.danmaku);\n    this.controller.registStage(new TestStage(), 1);\n    this.controller.mount();\n    // 监听大小变化\n    window.addEventListener(\"resize\", () => {\n      this.controller.resize();\n    });\n  }\n\n  /**\n   * 暂停\n   */\n  public pause() {\n    this.controller.pause();\n  }\n  /**\n   * 开始\n   */\n  public start() {\n    this.controller.start();\n  }\n  /**\n   * 跳转\n   */\n  public skip(time: number) {\n    this.controller.skip(time);\n  }\n  /**\n   * 当前时间\n   * @returns number\n   */\n  public time() {\n    return this.controller.getTime();\n  }\n  /**\n   * 重置弹幕尺寸\n   */\n  public resize() {\n    this.controller.resize();\n  }\n  /**\n   * 重置弹幕\n   */\n  public reset() {\n    this.controller.resetDanmaku(1);\n    this.controller.reset();\n  }\n  /**\n   * 添加事件监听\n   * @param event \n   * @param callback \n   */\n  public listenerEvent(event: DanmakuEventType, callback: (data:any) => void) {\n    DanmakuEvent.listener(event, callback);\n  }\n}\n\n// 添加进全局\nif (typeof globalThis !== \"undefined\") {\n  globalThis.MFADE = MFADE;\n} else {\n  window[\"MFADE\"] = MFADE;\n}\n"],"names":["module","exports","cssWithMappingToString","list","toString","this","map","item","content","concat","join","i","modules","mediaQuery","dedupe","alreadyImportedModules","length","id","_i","push","_arrayLikeToArray","arr","len","arr2","Array","_item","isArray","_arrayWithHoles","Symbol","iterator","_s","_e","_arr","_n","_d","call","next","done","value","err","_iterableToArrayLimit","o","minLen","n","Object","prototype","slice","constructor","name","from","test","_unsupportedIterableToArray","TypeError","_nonIterableRest","cssMapping","btoa","base64","unescape","encodeURIComponent","JSON","stringify","data","sourceMapping","sourceURLs","sources","source","sourceRoot","___CSS_LOADER_EXPORT___","memo","getTarget","target","styleTarget","document","querySelector","window","HTMLIFrameElement","contentDocument","head","e","stylesInDom","getIndexByIdentifier","identifier","result","modulesToDom","options","idCountMap","identifiers","base","count","index","obj","css","media","sourceMap","references","updater","addStyle","insertStyleElement","style","createElement","attributes","nonce","keys","forEach","key","setAttribute","insert","Error","appendChild","textStore","replaceText","replacement","filter","Boolean","applyToSingletonTag","remove","styleSheet","cssText","cssNode","createTextNode","childNodes","removeChild","insertBefore","applyToTag","removeAttribute","firstChild","singleton","singletonCounter","update","styleIndex","bind","parentNode","removeStyleElement","newObj","all","atob","lastIdentifiers","newList","newLastIdentifiers","_index","splice","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","getter","__esModule","d","a","definition","defineProperty","enumerable","get","prop","hasOwnProperty","language","debug","t","str","tranTxt","Context","string","lastTime","danmakuList","addDanmaku","danmaku","start","end","startTime","getAnimation","getDuration","timeToIndex","time","Math","floor","getDanmakuList","skip","DanmakuList","timeIndex","l","reset","getTimeLine","type","AdvancedLine","deepMerge","obj1","obj2","DanmakuEventType","b","c","px3","px2","px1","py3","py2","py1","epsilon","getX","getY","solve","x","g","abs","cubic","duration","getMatrix","isEnd","p","getProgress","getMatrixForCubic","getStyle","getCubicStyle","setParams","param","progress","getCubic","getProgressValue","cubicFunc","Cubic","add","sub","mult","a1","tran","b1","m","fill","j","k","getNullMatrix","animations","cumulativeMatrix","AnimationFactory","getAnimationsList","val","dur","Matrix","_progress","boxStyle","fontStyle","noneStyle","style2","matrix","CubicAnimations","cumulativeTime","curAnimation","getCurAnimation","animation","mat","opacity","_time","y","z","repeat","getCurTime","getAnimations","params","StaticAnimation","console","log","animationTime","origin","getMatrixForOrigin","scale","x1","y1","z1","x2","y2","z2","assign","OriginAnimations","path","angle","A2R","PI","sin","cos","RotationAnimation","animationList","ani","TranslateAnimation","RotationXAnimation","RotationYAnimation","RotationZAnimation","ScaleAnimations","ListAnimations","GroupAnimations","RepeatAnimations","OpacityAnimations","child","warn","getType","getContent","getChild","getDanmakuInstance","BaseDanmaku","buildPrefix","eventname","prefix","listener","callback","addEventListener","detail","dispatch","event","CustomEvent","dispatchEvent","parser","json","parse","getDanmaku","DanmakuEvent","DANMAKU_JSON_INVALID","I18n","dan","DANMAKU_FORMAT_ERROR","DanmakuFactory","childs","_danmaku","refresh","setCanvasContainer","canvas","updateCanvasStyle","width","size","height","left","position","top","backgroundColor","color","lengthSrting","num","Matrix3dString","SyntaxError","recursionDanmaku","danmakuobj","div","createDiv","setStyle","childObj","element","innerText","recursionDiv","array","ele","recursionStyle","abstime","parentTime","sty","max","transform","UnitTools","parentElement","canvasSize","PxSize","r","DanmakuTool","innerHTML","getRenderInstance","rendererList","ReferenceError","BaseRenderer","css3","CSS3Renderer","containers","stageList","pauseStatus","timeStamp","skipStatus","danmakuFunction","canvasStyle","getComputedStyle","initContainer","that","animloop","requestAnimationFrame","getContainersSize","parseInt","registStage","stage","mount","info","getDIV","render","RendererFactory","rendererType","stageRenderer","lineType","timeLineType","timeline","TimeLineFactory","timeLine","resetDanmaku","getCanvasStylByStage","classList","resize","getRenderer","stageSize","stageBackgroundColor","stagePosition","Date","now","pause","DANMAKU_STAGE_RESET","getTime","addGetDanmakuFunction","fun","DANMAKU_LOAD_START","res","JsonDanmakuParser","danmakuStr","DANMAKU_LOAD_DONE","getColor","containersSize","Color","renderer","timeLineObj","BaseStage","config","controller","Controller","TestStage","listenerEvent","globalThis","MFADE"],"sourceRoot":""}