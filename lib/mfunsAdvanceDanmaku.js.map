{"version":3,"sources":["webpack://mf-ade/./node_modules/css-loader/dist/runtime/api.js","webpack://mf-ade/./node_modules/css-loader/dist/runtime/cssWithMappingToString.js","webpack://mf-ade/./src/css/base.css","webpack://mf-ade/./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js","webpack://mf-ade/webpack/bootstrap","webpack://mf-ade/webpack/runtime/compat get default export","webpack://mf-ade/webpack/runtime/define property getters","webpack://mf-ade/webpack/runtime/hasOwnProperty shorthand","webpack://mf-ade/./src/css/base.css?6b6c","webpack://mf-ade/./src/ts/Context/Context.ts","webpack://mf-ade/./src/ts/i18n/zh-cn.ts","webpack://mf-ade/./src/ts/i18n/index.ts","webpack://mf-ade/./src/ts/core/Renderer/BaseRenderer.ts","webpack://mf-ade/./src/ts/util/UnitTools.ts","webpack://mf-ade/./src/ts/core/Style/Unit/PxSize.ts","webpack://mf-ade/./src/ts/core/Renderer/CSS3Renderer/CssDanmakuObj.ts","webpack://mf-ade/./src/ts/core/Renderer/CSS3Renderer/CSS3Renderer.ts","webpack://mf-ade/./src/ts/Factory/RendererFactory.ts","webpack://mf-ade/./src/ts/TimeLine/AdvancedLine.ts","webpack://mf-ade/./src/ts/Factory/TimeLineFactort.ts","webpack://mf-ade/./src/ts/util/deepMerge.ts","webpack://mf-ade/./src/ts/core/Animation/Base/Cubic.ts","webpack://mf-ade/./src/ts/Event/DanmakuEventType.ts","webpack://mf-ade/./src/ts/core/Animation/Base/CubicAnimations.ts","webpack://mf-ade/./src/ts/core/Animation/Base/Matrix.ts","webpack://mf-ade/./src/ts/core/Animation/CompositeAnimation/GroupAnimations.ts","webpack://mf-ade/./src/ts/core/Animation/CompositeAnimation/ListAnimations.ts","webpack://mf-ade/./src/ts/core/Animation/styleAnimations/OpacityAnimations.ts","webpack://mf-ade/./src/ts/core/Animation/TransformsAnimations/StaticAnimation.ts","webpack://mf-ade/./src/ts/core/Animation/CompositeAnimation/RepeatAnimations.ts","webpack://mf-ade/./src/ts/core/Animation/Base/OriginAnimations.ts","webpack://mf-ade/./src/ts/core/Animation/TransformsAnimations/ScaleAnimations.ts","webpack://mf-ade/./src/ts/core/Animation/TransformsAnimations/TranslateAnimation.ts","webpack://mf-ade/./src/ts/core/Animation/TransformsAnimations/RotationAnimation.ts","webpack://mf-ade/./src/ts/core/Animation/TransformsAnimations/RotationXAnimation.ts","webpack://mf-ade/./src/ts/core/Animation/TransformsAnimations/RotationYAnimation.ts","webpack://mf-ade/./src/ts/core/Animation/TransformsAnimations/RotationZAnimation.ts","webpack://mf-ade/./src/ts/Factory/AnimationFactory.ts","webpack://mf-ade/./src/ts/core/Danmaku/BaseDanmaku.ts","webpack://mf-ade/./src/ts/Factory/DanmakuParser/DanmakuFactory.ts","webpack://mf-ade/./src/ts/Event/DanmakuEvent.ts","webpack://mf-ade/./src/ts/Factory/DanmakuParser/JsonDanmakuParser.ts","webpack://mf-ade/./src/ts/Controller/Controller.ts","webpack://mf-ade/./src/ts/core/Style/Unit/Color.ts","webpack://mf-ade/./src/ts/core/Stage/BaseStage.ts","webpack://mf-ade/./src/ts/core/Stage/TestStage.ts","webpack://mf-ade/./src/ts/index.ts"],"names":["module","exports","cssWithMappingToString","list","toString","this","map","item","content","concat","join","i","modules","mediaQuery","dedupe","alreadyImportedModules","length","id","_i","push","_arrayLikeToArray","arr","len","arr2","Array","_item","isArray","_arrayWithHoles","Symbol","iterator","Object","_arr","_n","_d","_e","undefined","_s","next","done","value","err","_iterableToArrayLimit","o","minLen","n","prototype","call","slice","constructor","name","from","test","_unsupportedIterableToArray","TypeError","_nonIterableRest","cssMapping","btoa","base64","unescape","encodeURIComponent","JSON","stringify","data","sourceMapping","sourceURLs","sources","source","sourceRoot","___CSS_LOADER_EXPORT___","memo","getTarget","target","styleTarget","document","querySelector","window","HTMLIFrameElement","contentDocument","head","e","stylesInDom","getIndexByIdentifier","identifier","result","modulesToDom","options","idCountMap","identifiers","base","count","index","obj","css","media","sourceMap","references","updater","addStyle","insertStyleElement","style","createElement","attributes","nonce","keys","forEach","key","setAttribute","insert","Error","appendChild","textStore","replaceText","replacement","filter","Boolean","applyToSingletonTag","remove","styleSheet","cssText","cssNode","createTextNode","childNodes","removeChild","insertBefore","applyToTag","removeAttribute","firstChild","singleton","singletonCounter","update","styleIndex","bind","parentNode","removeStyleElement","newObj","all","atob","lastIdentifiers","newList","newLastIdentifiers","_index","splice","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","getter","__esModule","d","a","definition","defineProperty","enumerable","get","prop","hasOwnProperty","language","debug","t","str","tranTxt","Context","reset","addDanmaku","_danmaku","refresh","setCanvasContainer","canvas","updateCanvasStyle","width","size","string","height","left","position","x","top","y","backgroundColor","color","lengthSrting","num","Matrix3dString","SyntaxError","I18n","recursionDanmaku","danmaku","danmakuobj","div","createDiv","getContent","setStyle","getStyle","childObj","element","animation","getAnimation","child","start","startTime","getChild","innerText","recursionDiv","array","ele","assign","recursionStyle","abstime","parentTime","dan","sty","max","time","getMatrix","transform","UnitTools","parentElement","canvasSize","PxSize","danmakuList","r","DanmakuTool","innerHTML","getRenderInstance","type","rendererList","ReferenceError","BaseRenderer","css3","CSS3Renderer","lastTime","end","getDuration","timeToIndex","Math","floor","getDanmakuList","skip","DanmakuList","timeIndex","l","getTimeLine","AdvancedLine","deepMerge","obj1","obj2","DanmakuEventType","b","c","px3","px2","px1","py3","py2","py1","epsilon","getX","getY","solve","g","abs","cubic","duration","isEnd","p","getProgress","getMatrixForCubic","getCubicStyle","setParams","param","progress","getCubic","getProgressValue","cubicFunc","Cubic","add","sub","mult","a1","tran","b1","m","fill","j","k","getNullMatrix","animations","cumulativeMatrix","AnimationFactory","getAnimationsList","val","dur","Matrix","_progress","boxStyle","fontStyle","noneStyle","style2","matrix","CubicAnimations","cumulativeTime","curAnimation","getCurAnimation","mat","opacity","_time","z","repeat","getCurTime","getAnimations","params","StaticAnimation","console","log","animationTime","origin","getMatrixForOrigin","scale","x1","y1","z1","x2","y2","z2","OriginAnimations","path","angle","A2R","PI","sin","cos","RotationAnimation","animationList","ani","TranslateAnimation","RotationXAnimation","RotationYAnimation","RotationZAnimation","ScaleAnimations","ListAnimations","GroupAnimations","RepeatAnimations","OpacityAnimations","warn","getType","getDanmakuInstance","BaseDanmaku","buildPrefix","eventname","prefix","listener","callback","addEventListener","detail","dispatch","event","CustomEvent","dispatchEvent","parser","json","parse","getDanmaku","DanmakuEvent","DANMAKU_JSON_INVALID","DANMAKU_FORMAT_ERROR","DanmakuFactory","childs","containers","stageList","pauseStatus","timeStamp","skipStatus","danmakuFunction","canvasStyle","getComputedStyle","initContainer","that","animloop","requestAnimationFrame","getContainersSize","parseInt","registStage","stage","mount","info","getDIV","render","RendererFactory","rendererType","stageRenderer","lineType","timeLineType","timeline","TimeLineFactory","timeLine","resetDanmaku","getCanvasStylByStage","classList","resize","getRenderer","stageSize","stageBackgroundColor","stagePosition","Date","now","pause","DANMAKU_STAGE_RESET","getTime","addGetDanmakuFunction","fun","DANMAKU_LOAD_START","res","JsonDanmakuParser","danmakuStr","DANMAKU_LOAD_DONE","getColor","containersSize","Color","renderer","timeLineObj","BaseStage","config","controller","Controller","TestStage","listenerEvent","globalThis","MFADE"],"mappings":"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","file":"mfunsAdvanceDanmaku.js","sourcesContent":["\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\n// eslint-disable-next-line func-names\nmodule.exports = function (cssWithMappingToString) {\n  var list = []; // return the list of modules as css string\n\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = cssWithMappingToString(item);\n\n      if (item[2]) {\n        return \"@media \".concat(item[2], \" {\").concat(content, \"}\");\n      }\n\n      return content;\n    }).join(\"\");\n  }; // import a list of modules into the list\n  // eslint-disable-next-line func-names\n\n\n  list.i = function (modules, mediaQuery, dedupe) {\n    if (typeof modules === \"string\") {\n      // eslint-disable-next-line no-param-reassign\n      modules = [[null, modules, \"\"]];\n    }\n\n    var alreadyImportedModules = {};\n\n    if (dedupe) {\n      for (var i = 0; i < this.length; i++) {\n        // eslint-disable-next-line prefer-destructuring\n        var id = this[i][0];\n\n        if (id != null) {\n          alreadyImportedModules[id] = true;\n        }\n      }\n    }\n\n    for (var _i = 0; _i < modules.length; _i++) {\n      var item = [].concat(modules[_i]);\n\n      if (dedupe && alreadyImportedModules[item[0]]) {\n        // eslint-disable-next-line no-continue\n        continue;\n      }\n\n      if (mediaQuery) {\n        if (!item[2]) {\n          item[2] = mediaQuery;\n        } else {\n          item[2] = \"\".concat(mediaQuery, \" and \").concat(item[2]);\n        }\n      }\n\n      list.push(item);\n    }\n  };\n\n  return list;\n};","\"use strict\";\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return; var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nmodule.exports = function cssWithMappingToString(item) {\n  var _item = _slicedToArray(item, 4),\n      content = _item[1],\n      cssMapping = _item[3];\n\n  if (typeof btoa === \"function\") {\n    // eslint-disable-next-line no-undef\n    var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(cssMapping))));\n    var data = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(base64);\n    var sourceMapping = \"/*# \".concat(data, \" */\");\n    var sourceURLs = cssMapping.sources.map(function (source) {\n      return \"/*# sourceURL=\".concat(cssMapping.sourceRoot || \"\").concat(source, \" */\");\n    });\n    return [content].concat(sourceURLs).concat([sourceMapping]).join(\"\\n\");\n  }\n\n  return [content].join(\"\\n\");\n};","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".danmaku-containers{\\n    position: relative;\\n}\\n.danmaku-containers  *{\\n    box-sizing: border-box;\\n    transform-style: preserve-3d;\\n    margin: 0;\\n    padding: 0;\\n    font-family: Arial, Helvetica, sans-serif;\\n    font-size: 100px;\\n    image-rendering: pixelated; /* 小图片放大后像素不虚化 */\\n}\\n.danmaku-containers .stage{\\n    position: absolute;\\n    overflow: hidden;\\n    perspective:1000px;\\n    transform-style: preserve-3d;\\n}\\n.danmaku-containers-debug *{\\n    outline: 1px solid red;\\n}\\n\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://./src/css/base.css\"],\"names\":[],\"mappings\":\"AAAA;IACI,kBAAkB;AACtB;AACA;IACI,sBAAsB;IACtB,4BAA4B;IAC5B,SAAS;IACT,UAAU;IACV,yCAAyC;IACzC,gBAAgB;IAChB,0BAA0B,EAAE,gBAAgB;AAChD;AACA;IACI,kBAAkB;IAClB,gBAAgB;IAChB,kBAAkB;IAClB,4BAA4B;AAChC;AACA;IACI,sBAAsB;AAC1B\",\"sourcesContent\":[\".danmaku-containers{\\n    position: relative;\\n}\\n.danmaku-containers  *{\\n    box-sizing: border-box;\\n    transform-style: preserve-3d;\\n    margin: 0;\\n    padding: 0;\\n    font-family: Arial, Helvetica, sans-serif;\\n    font-size: 100px;\\n    image-rendering: pixelated; /* 小图片放大后像素不虚化 */\\n}\\n.danmaku-containers .stage{\\n    position: absolute;\\n    overflow: hidden;\\n    perspective:1000px;\\n    transform-style: preserve-3d;\\n}\\n.danmaku-containers-debug *{\\n    outline: 1px solid red;\\n}\\n\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","\"use strict\";\n\nvar isOldIE = function isOldIE() {\n  var memo;\n  return function memorize() {\n    if (typeof memo === 'undefined') {\n      // Test for IE <= 9 as proposed by Browserhacks\n      // @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n      // Tests for existence of standard globals is to allow style-loader\n      // to operate correctly into non-standard environments\n      // @see https://github.com/webpack-contrib/style-loader/issues/177\n      memo = Boolean(window && document && document.all && !window.atob);\n    }\n\n    return memo;\n  };\n}();\n\nvar getTarget = function getTarget() {\n  var memo = {};\n  return function memorize(target) {\n    if (typeof memo[target] === 'undefined') {\n      var styleTarget = document.querySelector(target); // Special case to return head of iframe instead of iframe itself\n\n      if (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n        try {\n          // This will throw an exception if access to iframe is blocked\n          // due to cross-origin restrictions\n          styleTarget = styleTarget.contentDocument.head;\n        } catch (e) {\n          // istanbul ignore next\n          styleTarget = null;\n        }\n      }\n\n      memo[target] = styleTarget;\n    }\n\n    return memo[target];\n  };\n}();\n\nvar stylesInDom = [];\n\nfunction getIndexByIdentifier(identifier) {\n  var result = -1;\n\n  for (var i = 0; i < stylesInDom.length; i++) {\n    if (stylesInDom[i].identifier === identifier) {\n      result = i;\n      break;\n    }\n  }\n\n  return result;\n}\n\nfunction modulesToDom(list, options) {\n  var idCountMap = {};\n  var identifiers = [];\n\n  for (var i = 0; i < list.length; i++) {\n    var item = list[i];\n    var id = options.base ? item[0] + options.base : item[0];\n    var count = idCountMap[id] || 0;\n    var identifier = \"\".concat(id, \" \").concat(count);\n    idCountMap[id] = count + 1;\n    var index = getIndexByIdentifier(identifier);\n    var obj = {\n      css: item[1],\n      media: item[2],\n      sourceMap: item[3]\n    };\n\n    if (index !== -1) {\n      stylesInDom[index].references++;\n      stylesInDom[index].updater(obj);\n    } else {\n      stylesInDom.push({\n        identifier: identifier,\n        updater: addStyle(obj, options),\n        references: 1\n      });\n    }\n\n    identifiers.push(identifier);\n  }\n\n  return identifiers;\n}\n\nfunction insertStyleElement(options) {\n  var style = document.createElement('style');\n  var attributes = options.attributes || {};\n\n  if (typeof attributes.nonce === 'undefined') {\n    var nonce = typeof __webpack_nonce__ !== 'undefined' ? __webpack_nonce__ : null;\n\n    if (nonce) {\n      attributes.nonce = nonce;\n    }\n  }\n\n  Object.keys(attributes).forEach(function (key) {\n    style.setAttribute(key, attributes[key]);\n  });\n\n  if (typeof options.insert === 'function') {\n    options.insert(style);\n  } else {\n    var target = getTarget(options.insert || 'head');\n\n    if (!target) {\n      throw new Error(\"Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.\");\n    }\n\n    target.appendChild(style);\n  }\n\n  return style;\n}\n\nfunction removeStyleElement(style) {\n  // istanbul ignore if\n  if (style.parentNode === null) {\n    return false;\n  }\n\n  style.parentNode.removeChild(style);\n}\n/* istanbul ignore next  */\n\n\nvar replaceText = function replaceText() {\n  var textStore = [];\n  return function replace(index, replacement) {\n    textStore[index] = replacement;\n    return textStore.filter(Boolean).join('\\n');\n  };\n}();\n\nfunction applyToSingletonTag(style, index, remove, obj) {\n  var css = remove ? '' : obj.media ? \"@media \".concat(obj.media, \" {\").concat(obj.css, \"}\") : obj.css; // For old IE\n\n  /* istanbul ignore if  */\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = replaceText(index, css);\n  } else {\n    var cssNode = document.createTextNode(css);\n    var childNodes = style.childNodes;\n\n    if (childNodes[index]) {\n      style.removeChild(childNodes[index]);\n    }\n\n    if (childNodes.length) {\n      style.insertBefore(cssNode, childNodes[index]);\n    } else {\n      style.appendChild(cssNode);\n    }\n  }\n}\n\nfunction applyToTag(style, options, obj) {\n  var css = obj.css;\n  var media = obj.media;\n  var sourceMap = obj.sourceMap;\n\n  if (media) {\n    style.setAttribute('media', media);\n  } else {\n    style.removeAttribute('media');\n  }\n\n  if (sourceMap && typeof btoa !== 'undefined') {\n    css += \"\\n/*# sourceMappingURL=data:application/json;base64,\".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))), \" */\");\n  } // For old IE\n\n  /* istanbul ignore if  */\n\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    while (style.firstChild) {\n      style.removeChild(style.firstChild);\n    }\n\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nvar singleton = null;\nvar singletonCounter = 0;\n\nfunction addStyle(obj, options) {\n  var style;\n  var update;\n  var remove;\n\n  if (options.singleton) {\n    var styleIndex = singletonCounter++;\n    style = singleton || (singleton = insertStyleElement(options));\n    update = applyToSingletonTag.bind(null, style, styleIndex, false);\n    remove = applyToSingletonTag.bind(null, style, styleIndex, true);\n  } else {\n    style = insertStyleElement(options);\n    update = applyToTag.bind(null, style, options);\n\n    remove = function remove() {\n      removeStyleElement(style);\n    };\n  }\n\n  update(obj);\n  return function updateStyle(newObj) {\n    if (newObj) {\n      if (newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap) {\n        return;\n      }\n\n      update(obj = newObj);\n    } else {\n      remove();\n    }\n  };\n}\n\nmodule.exports = function (list, options) {\n  options = options || {}; // Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n  // tags it will allow on a page\n\n  if (!options.singleton && typeof options.singleton !== 'boolean') {\n    options.singleton = isOldIE();\n  }\n\n  list = list || [];\n  var lastIdentifiers = modulesToDom(list, options);\n  return function update(newList) {\n    newList = newList || [];\n\n    if (Object.prototype.toString.call(newList) !== '[object Array]') {\n      return;\n    }\n\n    for (var i = 0; i < lastIdentifiers.length; i++) {\n      var identifier = lastIdentifiers[i];\n      var index = getIndexByIdentifier(identifier);\n      stylesInDom[index].references--;\n    }\n\n    var newLastIdentifiers = modulesToDom(newList, options);\n\n    for (var _i = 0; _i < lastIdentifiers.length; _i++) {\n      var _identifier = lastIdentifiers[_i];\n\n      var _index = getIndexByIdentifier(_identifier);\n\n      if (stylesInDom[_index].references === 0) {\n        stylesInDom[_index].updater();\n\n        stylesInDom.splice(_index, 1);\n      }\n    }\n\n    lastIdentifiers = newLastIdentifiers;\n  };\n};","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","import api from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../../node_modules/css-loader/dist/cjs.js!./base.css\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};","/**\n * 全局上下文\n */\nexport class Context{\n    /**\n     * 当前语言\n     */\n    public static language:string = \"zh-cn\";\n    public static debug = false;\n}\n\n","export default {\n    \"Containers is null\" : \"容器为空\",\n    \"Start mount stage\" : \"开始挂载舞台\",\n    \"Renderer type is null\": \"没有找到合适的渲染器\",\n    \"matrix3d param less than 16\":\"matrix3d 参数小于16个\",\n    \"Unknown danmaku format\":\"未知的弹幕格式\",\n    \"Danmaku parser fail\":\"高级弹幕解析失败，json格式可能存在问题\"\n}","import { Context } from \"../Context/Context\";\nimport zhCn from \"./zh-cn\";\n/**\n * i18n 国际化函数\n */\nexport class I18n {\n    private static tranTxt = {\n        \"zh-cn\": zhCn\n    }\n    /**\n     * 当前语言\n     */\n    private static language: string = Context.language;\n    /**\n     * 获取翻译，如果不存在，则返回自身\n     * @param str 需要国际化的字符串\n     * @returns 翻译结果\n     */\n    public static t(str: string): string {\n        // 检查字符串是否存在\n        if (this.tranTxt[this.language] && this.tranTxt[this.language][str]) {\n            return this.tranTxt[this.language][str];\n        }\n        return str;\n    }\n}","\n\nimport { DanmakuItemInterface } from \"../Danmaku/DanmakuItemInterface\";\nimport { CanvasStyle } from \"../Style/CanvasStyle\";\nimport { RendererInterface } from \"./RendererInterface\";\n\nexport class BaseRenderer implements RendererInterface {\n    public reset(): boolean {\n        throw new Error(\"Method not implemented.\");\n    }\n    public addDanmaku(_danmaku: DanmakuItemInterface): boolean {\n        return false;\n    }\n    public refresh(): boolean {\n        return false\n    }\n    protected canvas?: HTMLElement\n    public setCanvasContainer(canvas: HTMLElement): boolean {\n        this.canvas = canvas\n        return true\n    }\n    public updateCanvasStyle(style: CanvasStyle): boolean {\n        if (this.canvas) {\n            this.canvas.style.width = style.size.width.string();\n            this.canvas.style.height = style.size.height.string();\n            this.canvas.style.left = style.position.x.string()\n            this.canvas.style.top = style.position.y.string()\n            this.canvas.style.backgroundColor = style.color.string()\n            return true\n        } else {\n            return false\n        }\n    }\n}","import { I18n } from \"../i18n\";\n\nexport class UnitTools{\n    /**\n     * 拼接带单位的长度字符串\n     * @param num 长度\n     * @returns \n     */\n    public static lengthSrting(num:number):string{\n        return `${num}px`;\n    }\n    /**\n     * 拼接 Matrix3d() 字符串\n     * @param arr 16位数字\n     */\n    public static Matrix3dString(arr:number[]):string{\n        if(arr.length !== 16){\n            throw SyntaxError(I18n.t(\"matrix3d param less than 16\"));\n        }\n        return \"Matrix3d(\" + arr.join(\",\") + \")\";\n    }\n    // static UnitFactory(type:string,obj):string{\n\n    // }\n}","import { UnitInterface } from \"./UnitInterface\";\n\nexport class PxSize implements UnitInterface{\n    public length:number\n    constructor(length:number){\n        this.length = length;\n    }\n    public string(): string {\n        return this.length +\"px\";\n    }\n\n}","import { UnitTools } from \"src/ts/util/UnitTools\";\nimport { AnimationInterface } from \"../../Animation/Base/AnimationInterface\";\nimport { DanmakuItemInterface } from \"../../Danmaku/DanmakuItemInterface\";\nimport { DanmakuStyle } from \"../../Style/DanmakuStyle\";\n\nexport interface DanmakuObj {\n  element: HTMLElement;\n  style: DanmakuStyle;\n  animation: AnimationInterface;\n  child: DanmakuObj[];\n  start: number;\n}\nexport class DanmakuTool {\n  /**\n   * 递归构建弹幕对象\n   * @param danmaku\n   * @returns\n   */\n  public static recursionDanmaku(\n    danmaku: DanmakuItemInterface[]\n  ): DanmakuObj[] {\n    let danmakuobj: DanmakuObj[] = [];\n    danmaku.forEach((danmaku) => {\n      let div = this.createDiv(danmaku.getContent());\n      this.setStyle(div, danmaku.getStyle());\n      let obj: DanmakuObj = {\n        element: div,\n        animation: danmaku.getAnimation(),\n        style: danmaku.getStyle(),\n        child: [],\n        start: danmaku.startTime(),\n      };\n      let child = danmaku.getChild();\n      let childObj;\n      if (child) {\n        childObj = this.recursionDanmaku(child);\n      }\n\n      obj.child = childObj;\n      danmakuobj.push(obj);\n    });\n    return danmakuobj;\n  }\n  /**\n   * 创建一个空div\n   * @param content\n   * @returns\n   */\n  public static createDiv(content: string): HTMLElement {\n    let div = document.createElement(\"div\");\n    div.style.position = \"absolute\";\n    div.innerText = content;\n    return div;\n  }\n\n  /**\n   * 递归构建element\n   * @param danmakuobj\n   * @returns\n   */\n  public static recursionDiv(danmakuobj: DanmakuObj[]): HTMLElement[] {\n    let array: HTMLElement[] = [];\n    danmakuobj.forEach((item) => {\n      let element = item.element;\n      if (item.child) {\n        let eles = this.recursionDiv(item.child);\n        eles.forEach((ele) => {\n          element.appendChild(ele);\n        });\n      }\n      array.push(element);\n    });\n    return array;\n  }\n  /**\n   * 将样式设置到元素中\n   */\n  public static setStyle(element: HTMLElement, style: { [idx: string]: any }) {\n    Object.assign(element.style, style);\n  }\n  /**\n   * 递归设置弹幕动画\n   * @param danmaku\n   */\n  public static recursionStyle(\n    danmaku: DanmakuObj[],\n    canvas: HTMLElement,\n    abstime: number,\n    parentTime: number = 0\n  ) {\n    //console.log(danmaku);\n    danmaku.forEach((dan, key) => {\n      // 更新弹幕样式\n      let time =\n        parentTime === 0 ? abstime - dan.start : parentTime - dan.start;\n\n      // console.log(dan.animation);\n\n      let sty;\n      let max;\n      sty = dan.animation.getStyle(time);\n      if (sty) {\n        this.setStyle(dan.element, sty);\n      }\n      max = dan.animation.getMatrix(time);\n      if (max) {\n        dan.element.style.transform = UnitTools.Matrix3dString(max);\n      }\n      //console.log(dan);\n      // 如果都不存在，则表示动画已经完成，销毁元素\n      // 如果是子元素的情况，有可能存在弹幕未开始的情况\n      if (!(sty || max)) {\n        //console.log(dan);\n        if (dan.element.parentElement) {\n          // 从父元素删除节点\n          dan.element.parentElement.removeChild(dan.element);\n        } else {\n          // 否则从canvas里面删除\n          canvas.removeChild(dan.element);\n        }\n        // 并且清空节点\n        delete danmaku[key];\n      }\n      // 递归\n      this.recursionStyle(dan.child, canvas, abstime, time);\n    });\n  }\n}\n","import { UnitTools } from \"src/ts/util/UnitTools\";\nimport { DanmakuItemInterface } from \"../../Danmaku/DanmakuItemInterface\";\nimport { CanvasStyle } from \"../../Style/CanvasStyle\";\nimport { SizeInterface } from \"../../Style/SizeInterface\";\nimport { PxSize } from \"../../Style/Unit/PxSize\";\nimport { RendererInterface } from \"../RendererInterface\";\nimport { DanmakuObj, DanmakuTool } from \"./CssDanmakuObj\";\n\n\nexport class CSS3Renderer implements RendererInterface {\n\n    public canvasSize: SizeInterface = {\n        width: new PxSize(1920),\n        height: new PxSize(1080)\n    }\n    public canvas?: HTMLElement\n    public danmakuList: DanmakuObj[] = []\n    public setCanvasContainer(canvas: HTMLElement): boolean {\n        this.canvas = canvas\n        return true;\n    }\n    public updateCanvasStyle(style: CanvasStyle): boolean {\n        if (this.canvas) {\n            this.canvas.style.width = this.canvasSize.width.string();\n            this.canvas.style.height =this.canvasSize.height.string();\n            this.canvas.style.left = UnitTools.lengthSrting((style.size.width.length - this.canvasSize.width.length) / 2)\n            this.canvas.style.top = UnitTools.lengthSrting((style.size.height.length - this.canvasSize.height.length) / 2)\n            this.canvas.style.backgroundColor = style.color.string()\n            let r: number;// 缩放大小\n            if (style.size.width.length / style.size.height.length >= this.canvasSize.width.length / this.canvasSize.height.length) {\n                // 横向\n                r = style.size.height.length / this.canvasSize.height.length\n            } else {\n                // 纵向\n                r = style.size.width.length / this.canvasSize.width.length\n            }\n            this.canvas.style.transform = `scale(${r},${r})`\n\n            return true\n        } else {\n            return false\n        }\n    }\n    public addDanmaku(danmaku: DanmakuItemInterface): boolean {\n        if(!this.canvas) { return false }\n        let danmakuobj = DanmakuTool.recursionDanmaku([danmaku])\n        let eles = DanmakuTool.recursionDiv(danmakuobj)\n        eles.forEach((ele) => {\n            this.canvas?.appendChild(ele)\n        })\n        this.danmakuList.push(...danmakuobj);\n        // console.log(danmakuobj);\n\n        return true;\n    }\n\n\n\n    public refresh(time): boolean {\n        if (!this.canvas) {\n            return false;\n        }\n    \n        DanmakuTool.recursionStyle(this.danmakuList,this.canvas,time)\n        return true;\n    }\n    public reset(): boolean {\n        // 清空画布\n\n        if(this.canvas){\n            this.canvas.innerHTML = \"\";\n        }\n        // 清空数组\n        this.danmakuList = []\n        return true\n\n    }\n}\n","/**\n * 简单渲染器工厂\n */\n\nimport { I18n } from \"src/ts/i18n\";\nimport { BaseRenderer } from \"src/ts/core/Renderer/BaseRenderer\";\nimport { RendererInterface } from \"src/ts/core/Renderer/RendererInterface\";\nimport { CSS3Renderer } from \"../core/Renderer/CSS3Renderer/CSS3Renderer\";\n\nexport class RendererFactory{\n    public static rendererList = {\n        base:BaseRenderer,\n        css3:CSS3Renderer\n    }\n    public static getRenderInstance(type:string):RendererInterface{\n        if (this.rendererList[type]) {\n            return new this.rendererList[type]()\n        }else{\n            throw ReferenceError(I18n.t(\"Renderer type is null\"))\n        }\n    }\n}","import { DanmakuItemInterface } from \"../core/Danmaku/DanmakuItemInterface\";\nimport { TimeLineDanmaku } from \"./TimeLineDanmaku\";\nimport { TimeLineInterface } from \"./TimeLineInterface\";\n\n/**\n * 高级弹幕时间轴\n */\nexport class AdvancedLine implements TimeLineInterface {\n  /**\n   * 上次获取时间(10ms)\n   */\n  public lastTime: number = 0;\n  /**\n   * 时间轴,二维数组，一维是弹幕的开始10毫秒数，二维是此毫秒数下的弹幕集合\n   * 注意：为了节省性能，最小单位时间是10ms，\n   *       仅仅是数组下标是10ms，其余的都是按照ms计算的\n   */\n  public danmakuList: TimeLineDanmaku[][] = [];\n\n  /**\n   * 添加一个弹幕\n   * @param danmaku\n   * @param start\n   * @param end\n   */\n  public addDanmaku(\n    danmaku: DanmakuItemInterface,\n    start?: number,\n    end?: number\n  ) {\n    start = start || danmaku.startTime();\n\n    end = end || danmaku.getAnimation().getDuration() + start;\n    let index = this.timeToIndex(start);\n\n    if (!this.danmakuList[index]) {\n      this.danmakuList[index] = [];\n    }\n    this.danmakuList[index].push({\n      danmaku: danmaku,\n      start: start,\n      end: end,\n    });\n  }\n  /**\n   * 时间转换\n   * @param time\n   * @returns\n   */\n  protected timeToIndex(time: number): number {\n    return Math.floor(time / 16);\n  }\n  public getDanmakuList(time: number): {\n    skip: boolean;\n    DanmakuList: TimeLineDanmaku[];\n  } {\n    time = this.timeToIndex(time);\n    // 如果请求的时间超过了时间轴。。。\n    if (time < 0) {\n      return { skip: false, DanmakuList: [] };\n    }\n\n    let arr: TimeLineDanmaku[] = [];\n    let skip = false;\n    // 当两次时间超过200ms，表示发生了跳转\n    if (this.lastTime <= time && time - this.lastTime < 5) {\n      // 正常播放情况,遍历期间的所有内容\n      // console.log(this.lastTime);\n\n      for (let a = this.lastTime; a < time; a++) {\n        if (this.danmakuList[a]) {\n          // console.log(time);\n\n          arr.push(...this.danmakuList[a]);\n        }\n      }\n    } else {\n      // 否则说明播放发生了跳转，则遍历找到合适的内容\n      // 查找范围：在当前时间之前开始的，并且结束于当前时间之后的，\n      // 先找到之前开始的\n\n      for (let timeIndex = 0; timeIndex < time; timeIndex++) {\n        if (!this.danmakuList[timeIndex]) {\n          continue; // 当前时间不存在\n        }\n        // 接着再查找当前时间之后结束的\n        for (let l = 0; l < this.danmakuList[timeIndex].length; l++) {\n          if (\n            this.danmakuList[timeIndex][l] &&\n            this.timeToIndex(this.danmakuList[timeIndex][l].end) > time\n          ) {\n            arr.push(this.danmakuList[timeIndex][l]);\n          }\n        }\n      }\n      skip = true;\n    }\n    this.lastTime = time;\n\n    return { skip: skip, DanmakuList: arr };\n  }\n  public reset(): boolean {\n    this.danmakuList = [];\n    return true;\n  }\n}\n","import { AdvancedLine } from \"../TimeLine/AdvancedLine\";\nimport { TimeLineInterface } from \"../TimeLine/TimeLineInterface\";\n\nexport class TimeLineFactory{\n    public static list = {\n        \"defult\":AdvancedLine,\n        \"advance\":AdvancedLine\n    }\n    public static getTimeLine(type:string):TimeLineInterface{\n        if(!this.list[type]){\n           type = \"default\"\n        }\n        return new this.list[type]()\n    }\n}","/**\n * 对象深度合并\n * @param obj1\n * @param obj2\n * @returns\n */\nexport function deepMerge(obj1, obj2) {\n  let key;\n  // tslint:disable-next-line: forin\n  for (key in obj2) {\n    obj1[key] =\n      obj1[key] &&\n      obj1[key].toString() === \"[object Object]\" &&\n      obj2[key] &&\n      obj2[key].toString() === \"[object Object]\"\n        ? deepMerge(obj1[key], obj2[key])\n        : (obj1[key] = obj2[key]);\n  }\n  return obj1;\n}\n","/**\n * 贝塞尔相关工具函数\n */\nexport class Cubic {\n    public px3: number\n    public px2: number\n    public px1: number\n    public py3: number\n    public py2: number\n    public py1: number\n    public epsilon: number\n    constructor (a: number, b: number, c: number, d: number) {\n      this.px3 = 3 * a\n      this.px2 = 3 * (c - a) - this.px3\n      this.px1 = 1 - this.px3 - this.px2\n      this.py3 = 3 * b\n      this.py2 = 3 * (d - b) - this.py3\n      this.py1 = 1 - this.py3 - this.py2\n      this.epsilon = 1e-7      // 目标精度\n    }\n\n    public getX(t: number) {\n      return ((this.px1 * t + this.px2) * t + this.px3) * t\n    }\n\n    public getY(t: number) {\n      return ((this.py1 * t + this.py2) * t + this.py3) * t\n    }\n\n    public solve(x: number) {\n      if (x === 0 || x === 1) {             // 对 0 和 1 两个特殊 t 不做计算\n        return this.getY(x)\n      }\n      let t = x\n      for (let i = 0; i < 8; i++) {         // 进行 8 次迭代\n        let g = this.getX(t) - x\n        if (Math.abs(g) < this.epsilon) {   // 检测误差到可以接受的范围\n          return this.getY(t)\n        }\n        let d = (3 * this.px1 * t + 2 * this.px2) * t + this.px3   // 对 x 求导\n        if (Math.abs(d) < 1e-6) {           // 如果梯度过低，说明牛顿迭代法无法达到更高精度\n          break\n        }\n        t = t - g / d\n      }\n      return this.getY(t)                   // 对得到的近似 t 求 y\n    }\n  }\n","/**\n * 弹幕事件类型枚举\n */\nexport enum DanmakuEventType {\n  /**\n   * 弹幕字符串无效\n   */\n  DANMAKU_JSON_INVALID = \"DANMAKU_JSON_INVALID\",\n  /**\n   * 单条弹幕格式错误\n   */\n  DANMAKU_FORMAT_ERROR = \"DANMAKU_FORMAT_ERROR\",\n\n  /**\n   * 弹幕开始加载\n   */\n  DANMAKU_LOAD_START = \"DANMAKU_LOAD_START\",\n\n  /**\n   * 弹幕加载完成\n   */\n  DANMAKU_LOAD_DONE = \"DANMAKU_LOAD_DONE\",\n\n  /**\n   * 弹幕舞台重置\n   */\n  DANMAKU_STAGE_RESET = \"DANMAKU_STAGE_RESET\"\n}\n","import { DanmakuStyle } from \"../../Style/DanmakuStyle\";\nimport { AnimationInterface } from \"./AnimationInterface\";\nimport { Cubic } from \"./Cubic\";\n\n/**\n * 贝塞尔动画类\n */\nexport abstract class CubicAnimations implements AnimationInterface {\n\n    /**\n     * 贝塞尔函数\n     */\n    public cubicFunc: Cubic;\n    /**\n     * 贝塞尔参数\n     */\n    public cubic: [number, number, number, number] = [0, 0, 1, 1]\n    /**\n     * 动画总时间\n     */\n    public duration: number = 1000\n    // currentTime:number = 0\n    public getMatrix(time: number): false | number[] {\n        if (this.isEnd(time)) { return false }\n        let p = this.getProgress(time)\n        let a = this.getMatrixForCubic(p, this.duration * p)\n        return a\n    }\n    public getStyle(time: number): false | DanmakuStyle {\n        if (this.isEnd(time)) { return false }\n        let p = this.getProgress(time)\n        return this.getCubicStyle(p, this.duration * p)\n    }\n    public setParams(param?: { [idx: string]: any; }): boolean {\n        this.cubic = param?.cubic ? param?.cubic : this.cubic\n        this.duration = param?.duration ? param?.duration : this.duration\n        return true\n    }\n    public getDuration(): number {\n\n        return this.duration;\n    }\n    /**\n     * 根据动画时间获取动画进度\n     * @param time 动画时间\n     * @returns \n     */\n    public getProgress(time: number): number {\n        // 计算当前动画进度\n        let progress: number = time / this.duration\n        // 计算出实际动画进度\n        let a = this.getCubic().solve(progress)\n        return a;\n    }\n    /**\n     * 根据进度返回区间内的值\n     * @param start \n     * @param end \n     * @param progress \n     */\n    public getProgressValue(start: number, end: number, progress: number): number {\n        return start + (end - start) * progress\n    }\n    /**\n     * 判断动画是否结束\n     */\n    protected isEnd(time: number) {\n        return time > this.duration\n    }\n    /**\n     * 获取贝塞尔函数\n     * @returns \n     */\n    public getCubic(): Cubic {\n        if (!this.cubicFunc) {\n            this.cubicFunc = new Cubic(...this.cubic)\n        }\n        return this.cubicFunc;\n    }\n    /**\n     * 计算贝塞尔样式\n     * 注意：此处返回false仅表示未设置动画，请不要在此函数实现中判断动画结束\n     * @param progress 动画进度，0-1 有可能会超过此范围\n     */\n    public abstract getCubicStyle(progress: number, time: number): DanmakuStyle | false\n    /**\n     * 计算贝塞尔的矩阵\n     * 注意：此处返回false仅表示未设置动画，请不要在此函数实现中判断动画结束\n     * @param progress 动画进度，0-1 有可能会超过此范围\n     * @\n     */\n    public abstract getMatrixForCubic(progress: number, time: number): number[] | false\n\n}","/**\n * 矩阵变换相关工具函数\n */\nexport class Matrix {\n    /**\n     * 加法\n     * @param a \n     * @param b \n     */\n    public static add(a: number[], b: number[]): number[] {\n        let c: number[] = []\n        for (let i = 0; i < a.length; i++) {\n            c[i] = a[i] + b[i]\n        }\n        return c\n    }\n    /**\n     * 减法\n     * @param a \n     * @param b \n     * @returns \n     */\n    public static sub(a: number[], b: number[]): number[] {\n        let c: number[] = []\n        for (let i = 0; i < a.length; i++) {\n            c[i] = a[i] - b[i]\n        }\n        return c\n    }\n    public static mult(a: number[], b: number[]): number[] {\n        let a1 = this.tran(a);\n        let b1 = this.tran(b);\n         // 相乘约束\n        if (a1[0].length !== b1.length) {\n            throw new Error();\n        }\n        let m = a1.length;\n        let p = a1[0].length;\n        let n = b1[0].length;\n\n        // 初始化 m*n 全 0 二维数组\n        let c = new Array(m).fill(0).map(()=> new Array(n).fill(0));\n\n        for (let i = 0; i < m; i++) {\n            for (let j = 0; j < n; j++) {\n                for (let k = 0; k < p; k++) {\n                    c[i][j] += a1[i][k] * b1[k][j];\n                }\n            }\n        }\n\n        return [...c[0],...c[1],...c[2],...c[3]];\n    }\n    /**\n     * 将一维16位数组转换成4*4二维数组\n     * @param a \n     */\n    protected static tran(a: number[]):number[][] {\n        let arr: number[][] = []\n        for (let i = 0; i < 4; i++) {\n            for (let j = 0; j < 4; j++) {\n                let index = i * 4 + j\n                if(!arr[i]) { arr[i] = []; }\n                arr[i][j] = a[index];\n            }\n        }\n        return arr;\n    }\n    /**\n     * 获得一个无效果的4x4矩阵\n     */\n    public static getNullMatrix():number[]{\n        return [\n            1,0,0,0,\n            0,1,0,0,\n            0,0,1,0,\n            0,0,0,1\n        ]\n    }\n}","\nimport { AnimationFactory } from \"src/ts/Factory/AnimationFactory\";\nimport { deepMerge } from \"src/ts/util/deepMerge\";\nimport { DanmakuStyle } from \"../../Style/DanmakuStyle\";\nimport { AnimationInterface } from \"../Base/AnimationInterface\";\nimport { CubicAnimations } from \"../Base/CubicAnimations\";\nimport { Matrix } from \"../Base/Matrix\";\n\n\n/**\n * 动画组，用于多个动画并行播放\n */\nexport class GroupAnimations extends CubicAnimations {\n    public animations: AnimationInterface[] = []\n    /**\n     * 每个动画结束的累计矩阵\n     */\n    public cumulativeMatrix: number[][] = []\n    public setParams(param: { [idx: string]: any; }): boolean {\n        super.setParams(param);\n\n        this.animations = AnimationFactory.getAnimationsList(param?.animations || [])\n        // 计算出最大的动画时长\n        this.animations.forEach((val,key)=>{\n            let dur = val.getDuration()\n             // 计算最后一帧\n            this.cumulativeMatrix[key] = val.getMatrix(dur) || Matrix.getNullMatrix();\n            if(dur > this.duration){\n\n                // 这里覆盖了父类的属性\n                // 实际上，只有父类的时长不够，才会被更新\n                this.duration = val.getDuration();\n            }\n        })\n\n        return true;\n    }\n    public getCubicStyle(_progress: number,time:number): false | DanmakuStyle {\n        /**\n         * 合并样式，由于样式的特殊性，如果存在冲突的样式，后面的会覆盖前面的\n         */\n        let style:DanmakuStyle = {boxStyle:{},fontStyle:{}};\n        let noneStyle = true;\n        for (const animation of this.animations) {\n            let style2 = animation.getStyle(time)\n            if(style2){\n                noneStyle = false;\n                style = deepMerge(style,style2);\n            }\n        }\n        // for(let i = 0;i<this.animations.length;i++){\n        //     let style2 = this.animations[i].getStyle(time)\n        //     if(style2){\n        //         noneStyle = false;\n        //         style = dseepMerge(style,style2);\n        //     }\n\n        // }\n        if(noneStyle) { return false; }\n        return style;\n    }\n    public getMatrixForCubic(_progress: number,time:number): false | number[] {\n        // 建立一个空白矩阵\n        let arr:number[] = [\n            1,0,0,0,\n            0,1,0,0,\n            0,0,1,0,\n            0,0,0,1\n        ]\n        // 倒着计算所有的矩阵\n        for(let i = this.animations.length - 1;i >= 0;i--){\n            let matrix = this.animations[i].getMatrix(time)\n            // console.log(matrix);\n\n            if(matrix){\n                arr = Matrix.mult(arr,matrix);\n            }else{\n                arr = Matrix.mult(arr,this.cumulativeMatrix[i]);\n            }\n        }\n\n        return arr;\n    }\n\n}","import { AnimationFactory } from \"src/ts/Factory/AnimationFactory\";\nimport { DanmakuStyle } from \"../../Style/DanmakuStyle\";\nimport { AnimationInterface } from \"../Base/AnimationInterface\";\nimport { CubicAnimations } from \"../Base/CubicAnimations\";\nimport { Matrix } from \"../Base/Matrix\";\n/**\n * 动画列表组，所有动画按顺序播放\n */\nexport class ListAnimations extends CubicAnimations {\n    public animations: AnimationInterface[] = []\n    /**\n     * 每个动画结束的累计矩阵\n     */\n    public cumulativeMatrix: number[][] = []\n    public cumulativeTime: number[] = []\n    public setParams(param: { [idx: string]: any; }): boolean {\n        super.setParams(param);\n        this.animations = AnimationFactory.getAnimationsList(param?.animations || [])\n\n        let duration = 0;\n        this.cumulativeMatrix[0] = Matrix.getNullMatrix();\n        this.cumulativeTime[0] = duration\n\n        this.animations.forEach((val, key) => {\n            let dur = val.getDuration()\n\n\n            // 自增1，因为0的结束帧的1的开头\n            key++\n            // 计算出每个动画结束后的矩阵叠加,传入持续时间以获得最后一帧动画\n            let matrix = val.getMatrix(dur) || Matrix.getNullMatrix();\n            // 叠加\n            this.cumulativeMatrix[key] =\n                Matrix.mult(matrix, this.cumulativeMatrix[key - 1])\n\n            duration += dur;\n            this.cumulativeTime[key] = duration\n\n        })\n\n        if (this.duration < duration) { this.duration = duration; }\n\n        return true;\n    }\n\n    public getCubicStyle(_progress: number, time: number): false | DanmakuStyle {\n        let curAnimation = this.getCurAnimation(time)\n\n        if (curAnimation) {\n            return curAnimation.animation.getStyle(time)\n        }\n        return false\n    }\n\n    public getMatrixForCubic(_progress: number, time: number): false | number[] {\n\n\n        let curAnimation = this.getCurAnimation(time)\n\n        if (curAnimation) {\n\n            time = time - this.cumulativeTime[curAnimation.key]\n\n            let mat = curAnimation.animation.getMatrix(time) || Matrix.getNullMatrix()\n            return Matrix.mult(mat, this.cumulativeMatrix[curAnimation.key])\n        }\n        return false\n    }\n    /**\n     * 获取当前的动画元素,如果不存在则返回false\n     */\n    protected getCurAnimation(time: number): { key: number, animation: AnimationInterface } | false {\n\n        for (let i = this.animations.length - 1; i >= 0; i--) {\n            let duration = this.cumulativeTime[i]\n            if (time > duration) {\n                return { key: i, animation: this.animations[i] }\n            }\n        }\n        return false\n    }\n\n}","import { DanmakuStyle } from \"../../Style/DanmakuStyle\";\nimport { CubicAnimations } from \"../Base/CubicAnimations\";\n\n/**\n * 透明度动画\n *\n * @export\n * @class OpacityAnimations\n * @extends {CubicAnimations}\n */\nexport class OpacityAnimations extends CubicAnimations{\n    public opacity:[number,number] = [0,1]\n    public setParams(param?: { [idx: string]: any; }):boolean{\n        super.setParams(param);\n        this.opacity = param?.opacity || this.opacity\n        return true\n    }\n    public getCubicStyle(progress: number, _time: number): false | DanmakuStyle {\n        return {\n            opacity:this.getProgressValue(this.opacity[0],this.opacity[1],progress)\n        }\n    }\n    public getMatrixForCubic(_progress: number, _time: number): false | number[] {\n        return false\n    }\n\n}","import { DanmakuStyle } from \"../../Style/DanmakuStyle\";\nimport { AnimationInterface } from \"../Base/AnimationInterface\";\n\n/**\n * 静止动画 仅仅悬停在某一个位置一定时间\n */\nexport class StaticAnimation implements AnimationInterface {\n    public getDuration(): number {\n        return this.duration;\n    }\n\n    public duration: number = 1000;\n    public x: number = 0;\n    public y: number = 0;\n    public z: number = 0;\n    public setParams(param: { [idx: string]: any; }): boolean {\n        let def = 0;\n        this.duration = param?.duration || this.duration\n        this.x = param?.x || def\n        this.y = param?.y || def\n        this.z = param?.z || def\n        return true\n    }\n    public getMatrix(time: number): false | number[] {\n        // console.log(time);\n\n        if (time > this.duration) { return false; }\n\n        return [\n            1, 0, 0, 0,\n            0, 1, 0, 0,\n            0, 0, 1, 0,\n            this.x, this.y, this.z, 1\n        ]\n\n    }\n    public getStyle(): false | DanmakuStyle {\n        return false\n    }\n\n}","import { AnimationFactory } from \"src/ts/Factory/AnimationFactory\";\nimport { DanmakuStyle } from \"../../Style/DanmakuStyle\";\nimport { AnimationInterface } from \"../Base/AnimationInterface\";\nimport { CubicAnimations } from \"../Base/CubicAnimations\";\nimport { StaticAnimation } from \"../TransformsAnimations/StaticAnimation\";\n\nexport class RepeatAnimations extends CubicAnimations{\n    /**\n     * 动画接口\n     */\n    public animation:AnimationInterface\n    /**\n     * 重复次数\n     */\n    public repeat:number = 1\n    /**\n     * 单个动画时间\n     */\n    public animationTime:number\n    public getCubicStyle(_progress: number, time: number): false | DanmakuStyle {\n        return this.animation.getStyle(this.getCurTime(time))\n    }\n    public getMatrixForCubic(_progress: number, time: number): false | number[] {\n        return this.animation.getMatrix(this.getCurTime(time))\n    }\n    public setParams(param: { [idx: string]: any; }): boolean {\n        super.setParams(param);\n\n        if(param?.animation){\n            this.animation =  AnimationFactory.getAnimations(param?.animation.type,param?.animation.params) || new StaticAnimation()\n\n        }else{\n            this.animation = new StaticAnimation()\n        }\n\n        console.log(this.animation);\n\n        this.repeat = param?.repeat || this.repeat\n        this.animationTime = this.animation.getDuration()\n        // 覆盖父级存活时间 \n        // 计算方式 单个弹幕时间 X 弹幕重复次数\n        this.duration = this.animationTime * this.repeat\n        console.log(this.duration);\n\n        return true\n    }\n    /**\n     * 获得当前的弹幕时间\n     */\n    public getCurTime(time:number){\n        // 取余\n        return time % this.animationTime\n    }\n}","import { CubicAnimations } from \"./CubicAnimations\";\nimport { Matrix } from \"./Matrix\";\n\n/**\n * 可改变动画中心点的动画\n *\n * @export\n * @abstract\n * @class OriginAnimations\n * @extends {CubicAnimations}\n */\nexport abstract class OriginAnimations extends CubicAnimations {\n    public origin:number[] = [0,0,0]\n    public setParams(param: { [idx: string]: any; }): boolean {\n        if (!super.setParams(param)) { return false; }\n        this.origin =  param?.origin || this.origin\n        return true\n    }\n    public getMatrixForCubic(progress: number): number[] | false{\n        let arr = this.getMatrixForOrigin(progress)\n        if(!arr) { return false }\n        arr = Matrix.mult([\n            1, 0, 0, 0,\n            0, 1, 0, 0,\n            0, 0, 1, 0,\n            -this.origin[0], -this.origin[1], -this.origin[2], 1\n\n        ],                arr)\n        return Matrix.mult(arr,[\n            1, 0, 0, 0,\n            0, 1, 0, 0,\n            0, 0, 1, 0,\n            this.origin[0], this.origin[1], this.origin[2], 1\n\n        ])\n    }\n    /**\n     * 获取用于计算原坐标点的矩阵\n     * @param progress \n     */\n    public abstract getMatrixForOrigin(progress: number): number[] | false\n}","import { DanmakuStyle } from \"../../Style/DanmakuStyle\";\nimport { OriginAnimations } from \"../Base/OriginAnimations\";\n\n/**\n * 缩放动画\n */\nexport class ScaleAnimations extends OriginAnimations{\n    public scale:{x1:number,y1:number,z1:number,x2:number,y2:number,z2:number}\n    = {x1:1,y1:1,z1:1,x2:1,y2:1,z2:1}\n    public setParams(param: { [idx: string]: any; }): boolean {\n        if (!super.setParams(param)) { return false; }\n        this.scale = Object.assign(this.scale,param?.scale)\n        return true\n    }\n    public getMatrixForOrigin(progress: number): false | number[] {\n        let x = this.getProgressValue(this.scale.x1, this.scale.x2, progress);\n        let y = this.getProgressValue(this.scale.y1, this.scale.y2, progress)\n        let z = this.getProgressValue(this.scale.z1, this.scale.z2, progress)\n        let m = [\n            x,0,0,0,\n            0,y,0,0,\n            0,0,z,0,\n            0,0,0,1\n        ]\n        return m\n\n    }\n    public getCubicStyle(_progress: number): false | DanmakuStyle {\n       return false\n    }\n\n}","import { DanmakuStyle } from \"../../Style/DanmakuStyle\";\nimport { CubicAnimations } from \"../Base/CubicAnimations\";\n\nexport class TranslateAnimation extends CubicAnimations {\n\n    public path: { x1: number, y1: number, z1: number, x2: number, y2: number, z2: number }\n        =\n        { x1: 0, y1: 0, x2: 0, y2: 0, z1: 0, z2: 0 }\n    public setParams(param: { [idx: string]: any; }): boolean {\n        if (!super.setParams(param)) { return false; }\n        this.path = Object.assign(this.path,param?.path)\n        return true\n    }\n    public getCubicStyle(): false | DanmakuStyle {\n        return false;\n    }\n    public getMatrixForCubic(progress: number): false | number[] {\n        // console.log(this.path);\n        // console.log(progress);\n\n        let x = this.getProgressValue(this.path.x1, this.path.x2, progress);\n        let y = this.getProgressValue(this.path.y1, this.path.y2, progress)\n        let z = this.getProgressValue(this.path.z1, this.path.z2, progress)\n\n        return [\n            1, 0, 0, 0,\n            0, 1, 0, 0,\n            0, 0, 1, 0,\n            x, y, z, 1\n        ]\n    }\n}","import { DanmakuStyle } from \"../../Style/DanmakuStyle\";\nimport { OriginAnimations } from \"../Base/OriginAnimations\";\n\n/**\n * 旋转父类\n */\nexport abstract class RotationAnimation extends OriginAnimations {\n\n    public angle:{start:number,end:number} = {start:0,end:360}\n    public setParams(param: { [idx: string]: any; }): boolean {\n        if (!super.setParams(param)) { return false; }\n        this.angle = Object.assign(this.angle,param?.angle)\n        return true\n    }\n    public getCubicStyle(_progress: number): false | DanmakuStyle {\n        return false;\n    }\n    /**\n     * 角度转弧度\n     */\n    protected A2R(a: number) {\n        return a * (Math.PI / 180)\n    }\n}","import { RotationAnimation } from \"./RotationAnimation\";\n\n/**\n * X轴旋转\n */\nexport class RotationXAnimation extends RotationAnimation {\n    public getMatrixForOrigin(progress: number): false | number[] {\n        let angle = this.getProgressValue(this.angle.start,this.angle.end,progress)\n        let sin = Math.sin(this.A2R(angle));\n        let cos = Math.cos(this.A2R(angle))\n        return [\n            1, 0, 0, 0,\n            0, cos, sin, 0,\n            0, -sin, cos, 0,\n            0, 0, 0, 1\n        ]\n    }\n}","import { RotationAnimation } from \"./RotationAnimation\";\n/**\n * y轴旋转\n */\nexport class RotationYAnimation extends RotationAnimation {\n    public getMatrixForOrigin(progress: number): false | number[] {\n        let angle = this.getProgressValue(this.angle.start,this.angle.end,progress)\n        let sin = Math.sin(this.A2R(angle));\n        let cos = Math.cos(this.A2R(angle))\n        return [\n            cos, 0, sin, 0,\n            0, 1, 0, 0,\n            -sin, 0, cos, 0,\n            0, 0, 0, 1\n        ]\n    }\n}","import { RotationAnimation } from \"./RotationAnimation\";\n\n/**\n * z轴旋转\n */\nexport class RotationZAnimation extends RotationAnimation {\n    public getMatrixForOrigin(progress: number): false | number[] {\n        let angle = this.getProgressValue(this.angle.start,this.angle.end,progress)\n        let sin = Math.sin(this.A2R(angle));\n        let cos = Math.cos(this.A2R(angle))\n        return [\n            cos,sin, 0, 0,\n            -sin, cos, 0, 0,\n            0, 0,1, 0,\n            0, 0, 0, 1\n        ]\n    }\n}","import { AnimationInterface } from \"../core/Animation/Base/AnimationInterface\";\nimport { GroupAnimations } from \"../core/Animation/CompositeAnimation/GroupAnimations\";\nimport { ListAnimations } from \"../core/Animation/CompositeAnimation/ListAnimations\";\nimport { OpacityAnimations } from \"../core/Animation/styleAnimations/OpacityAnimations\";\nimport { RepeatAnimations } from \"../core/Animation/CompositeAnimation/RepeatAnimations\";\nimport { ScaleAnimations } from \"../core/Animation/TransformsAnimations/ScaleAnimations\";\nimport { TranslateAnimation } from \"../core/Animation/TransformsAnimations/TranslateAnimation\";\nimport { RotationXAnimation } from \"../core/Animation/TransformsAnimations/RotationXAnimation\";\nimport { RotationYAnimation } from \"../core/Animation/TransformsAnimations/RotationYAnimation\";\nimport { RotationZAnimation } from \"../core/Animation/TransformsAnimations/RotationZAnimation\";\nimport { StaticAnimation } from \"../core/Animation/TransformsAnimations/StaticAnimation\";\n\nexport class AnimationFactory {\n    public static animationList = {\n        \"static\":StaticAnimation,// 静态定位\n        \"translate\":TranslateAnimation,// 平移\n        \"rotateX\":RotationXAnimation,// x轴旋转\n        \"rotateY\":RotationYAnimation,// y轴旋转\n        \"rotateZ\":RotationZAnimation,// z轴旋转\n        \"scale\":ScaleAnimations,// 缩放\n        \"list\":ListAnimations,// 动画列表\n        \"group\":GroupAnimations,// 动画组\n        \"repeat\":RepeatAnimations,// 重复动画\n        \"opacity\":OpacityAnimations\n    }\n\n    public static getAnimations(type:string,params):AnimationInterface | false{\n        if(this.animationList[type]){\n            // console.log(params);\n            let ani = new this.animationList[type]()\n            // console.log(ani);\n\n            ani.setParams(params)\n            return ani;\n        }\n        return false;\n    }\n    public static getAnimationsList(list:{key: { [idx: string]: any; }}[]):AnimationInterface[]{\n        let animationList:AnimationInterface[] = []\n\n        list?.forEach((val)=>{\n            let ani =  this.getAnimations(val[\"type\"],val)\n            if(ani){\n                animationList.push(ani);\n            }\n        })\n        return animationList\n    }\n}","import { DanmakuStyle } from \"../Style/DanmakuStyle\";\nimport { AnimationInterface } from \"../Animation/Base/AnimationInterface\";\nimport { DanmakuItemInterface } from \"./DanmakuItemInterface\";\nimport { StaticAnimation } from \"../Animation/TransformsAnimations/StaticAnimation\";\n\n/**\n * 基础弹幕类型\n */\nexport class BaseDanmaku implements DanmakuItemInterface {\n  public style: DanmakuStyle = {};\n  public start: number = 0;\n  public animation?: AnimationInterface;\n  public content: string = \"\";\n  public child: DanmakuItemInterface[] = [];\n  /**\n   * 设置参数\n   * @param param\n   * @returns\n   */\n  public setParams(param: { [idx: string]: any }): boolean {\n    // 设置文字样式\n    try {\n      // 设置开始时间\n      if (param?.start) {\n        this.start = param?.start;\n      }\n      if (param?.animation) {\n        this.animation = param?.animation || new StaticAnimation();}\n      if (param?.child) { this.child = param.child; }\n      if (param?.style) { this.style = param?.style; }\n      if (param?.content) { this.content = param?.content;}\n    } catch (e) {\n      console.warn(e);\n      return false;\n    }\n\n    return true;\n  }\n  public getType(): string {\n    return \"base\";\n  }\n  public getContent(): string {\n    return this.content;\n  }\n  public getChild(): DanmakuItemInterface[] {\n    return this.child;\n  }\n  public getAnimation(): AnimationInterface {\n    if (!this.animation) {\n      this.animation = new StaticAnimation();\n    }\n    return this.animation;\n  }\n  public getStyle(): DanmakuStyle {\n    return this.style;\n  }\n  public startTime(): number {\n    return this.start;\n  }\n}\n","import { BaseDanmaku } from \"src/ts/core/Danmaku/BaseDanmaku\";\nimport { DanmakuItemInterface } from \"src/ts/core/Danmaku/DanmakuItemInterface\";\n\n/**\n * 弹幕解析器工厂\n */\nexport class DanmakuFactory{\n    public static list = {\n        \"text\":BaseDanmaku\n    }\n    public static getDanmakuInstance(type:string):DanmakuItemInterface{\n        if(!this.list[type]){\n            type = \"text\"\n        }\n        return new this.list[type]()\n    }\n}","import { DanmakuEventType } from \"./DanmakuEventType\";\n\n/**\n * 弹幕事件工具\n */\nexport class DanmakuEvent {\n  // 事件前缀，防止冲突\n  public static prefix = \"_danmakuevent_\";\n\n  /**\n   * 包装事件名称字符串\n   * @param eventname 事件名称\n   * @returns\n   */\n  protected static buildPrefix(eventname: DanmakuEventType): string {\n    return this.prefix + eventname;\n  }\n  /**\n   * 监听弹幕事件\n   * @param eventname \n   * @param callback \n   */\n  public static listener<T>(eventname: DanmakuEventType, callback: (data: T) => void) {\n    // 封装浏览器提供的事件监听器\n    window.addEventListener(this.buildPrefix(eventname), (data: any) => {\n      callback(data.detail);\n    });\n  }\n\n  /**\n   * 触发弹幕事件\n   * @param eventname\n   * @param data\n   */\n  public static dispatch<T>(eventname: DanmakuEventType, data: T) {\n    // 包装事件\n    let event = new CustomEvent(this.buildPrefix(eventname), {\n      detail: data,\n    });\n    // 触发事件\n    window.dispatchEvent(event);\n  }\n}\n","import { I18n } from \"src/ts/i18n\";\nimport { DanmakuItemInterface } from \"src/ts/core/Danmaku/DanmakuItemInterface\";\nimport { AnimationFactory } from \"../AnimationFactory\";\nimport { DanmakuFactory } from \"./DanmakuFactory\";\nimport { DanmakuParserInterface } from \"./DanmakuParserInterface\";\nimport { DanmakuEvent } from \"src/ts/Event/DanmakuEvent\";\nimport { DanmakuEventType } from \"src/ts/Event/DanmakuEventType\";\n\n/**\n * JSON 格式弹幕解析器\n */\nexport class JsonDanmakuParser implements DanmakuParserInterface {\n  public parser(content: string): DanmakuItemInterface[] {\n    try {\n      let json: any[] = JSON.parse(content);\n      return this.getDanmaku(json);\n    } catch (e) {\n      // 触发弹幕格式无效事件\n      DanmakuEvent.dispatch(\n        DanmakuEventType.DANMAKU_JSON_INVALID,\n        I18n.t(\"Danmaku parser fail\")\n      );\n      console.warn(I18n.t(\"Danmaku parser fail\"));\n      console.warn(e);\n      return [];\n    }\n  }\n\n  /**\n   * 获取弹幕\n   * @param obj \n   * @returns \n   */\n  public getDanmaku(obj?: any[]): DanmakuItemInterface[] {\n    let list: DanmakuItemInterface[] = [];\n\n    /**\n     * 遍历弹幕列表\n     */\n    obj?.forEach((dan,index) => {\n      /**\n       * 检测弹幕类型是否正确\n       */\n      if (typeof dan !== \"object\") {\n        console.warn(`${I18n.t(\"Unknown danmaku format\")} :  ${dan}  index: + ${index}`);\n        // 触发弹幕类型错误事件\n        DanmakuEvent.dispatch(DanmakuEventType.DANMAKU_FORMAT_ERROR,{\n          content:dan,\n          index\n        })\n      } else {\n        let danmaku = DanmakuFactory.getDanmakuInstance(dan.type);\n        if (!dan?.animations || dan?.animations === []) {\n          dan.animations = [{ type: \"static\" }];\n        }\n        danmaku.setParams({\n          start: dan?.start,\n          content: dan?.content,\n          style: dan?.style,\n          animation: AnimationFactory.getAnimations(\"list\", {\n            animations: dan?.animations,\n          }), // 将列表组成一个list\n          child: this.getDanmaku(dan.childs),\n        });\n\n        list.push(danmaku);\n      }\n    });\n    return list;\n  }\n}\n","import { SizeInterface } from \"../core/Style/SizeInterface\";\nimport { StageInterface } from \"../core/Stage/StageInterface\";\nimport { Context } from \"../Context/Context\";\nimport { I18n } from \"../i18n\";\nimport { CanvasStyle } from \"../core/Style/CanvasStyle\";\nimport { RendererFactory } from \"src/ts/Factory/RendererFactory\";\nimport { PxSize } from \"../core/Style/Unit/PxSize\";\nimport { TimeLineFactory } from \"../Factory/TimeLineFactort\";\nimport { JsonDanmakuParser } from \"../Factory/DanmakuParser/JsonDanmakuParser\";\nimport { DanmakuEvent } from \"../Event/DanmakuEvent\";\nimport { DanmakuEventType } from \"../Event/DanmakuEventType\";\n\n/**\n * 控制器 ，统一管理整个弹幕系统\n * 在这里，每种弹幕类型都会得到一个舞台对象，进行渲染\n */\nexport class Controller {\n  /**\n   * 画布对象\n   */\n  protected containers: HTMLElement;\n  /**\n   * 实时的Css样式表\n   */\n  protected canvasStyle: CSSStyleDeclaration;\n  /**\n   * 舞台列表\n   */\n  protected stageList: StageInterface[] = [];\n  /**\n   * 暂停状态\n   */\n  protected pauseStatus: boolean = true;\n  /**\n   * 时间戳\n   */\n  protected timeStamp: number = 0;\n  /**\n   * 播放的时间\n   */\n  protected time: number = 0;\n  /**\n   * 跳转状态\n   */\n  public skipStatus: boolean = false;\n\n  protected danmakuFunction: {\n    [type: string]: (send: (str: string[]) => void) => void;\n  } = {};\n  constructor(containers: HTMLElement) {\n    this.containers = containers;\n    // 获取实时的style对象，当大小发生变化时，会更新自身\n    this.canvasStyle = window.getComputedStyle(containers);\n    // 初始化容器\n    this.initContainer();\n    let that = this;\n    (function animloop() {\n      if (!that.pauseStatus) {\n        that.refresh();\n      }\n      requestAnimationFrame(animloop);\n    })();\n  }\n  /**\n   * 获得容器尺寸\n   */\n  public getContainersSize(): SizeInterface {\n    return {\n      width: new PxSize(parseInt(this.canvasStyle.width, 10)),\n      height: new PxSize(parseInt(this.canvasStyle.height, 10)),\n    };\n  }\n  /**\n   * 将一个舞台添加到容器内\n   * @param stage 舞台\n   * @param index 排列顺序\n   * @returns 成功与失败的状态\n   */\n  public registStage(stage: StageInterface, index: number): boolean {\n    // 检查列表中是否存在\n    if (this.stageList[index]) {\n      return false;\n    }\n    this.stageList[index] = stage;\n    return true;\n  }\n  /**\n   * 将舞台挂载到容器中\n   */\n  public mount() {\n    console.info(I18n.t(\"Start mount stage\"));\n    // 遍历每一个舞台\n    this.stageList.forEach((stage, key) => {\n      // 获取一个div\n      let div = this.getDIV();\n      // 给舞台初始化渲染器\n      let render = RendererFactory.getRenderInstance(stage.rendererType());\n      // 将div挂载到渲染器\n      render.setCanvasContainer(div);\n      // 设置舞台渲染器\n      stage.stageRenderer(render);\n      // 设置舞台时间轴\n      let lineType = stage.timeLineType();\n      let timeline = TimeLineFactory.getTimeLine(lineType);\n      stage.timeLine(timeline);\n      // 检察是否存在弹幕获取器\n      if (this.danmakuFunction[lineType]) {\n        // 如果存在，就获取弹幕\n        this.resetDanmaku(key);\n      } else {\n        console.warn(I18n.t(\"danmaku get function is null :\" + lineType));\n      }\n\n      // 更新渲染器内画布样式\n      render.updateCanvasStyle(this.getCanvasStylByStage(stage));\n    });\n  }\n\n  /**\n   * 初始化弹幕容器\n   */\n  protected initContainer() {\n    if (Context.debug) {\n      // debug模式\n      this.containers.classList.add(\"danmaku-containers-debug\");\n    }\n    this.containers.classList.add(\"danmaku-containers\");\n  }\n\n  /**\n   * 重置尺寸\n   */\n  public resize() {\n    // 重置舞台的尺寸\n    this.stageList.forEach((stage) => {\n      let render = stage.getRenderer();\n      if (render) {\n        render.updateCanvasStyle(this.getCanvasStylByStage(stage));\n      }\n    });\n  }\n\n  /**\n   * 创建div容器\n   */\n  protected getDIV(): HTMLElement {\n    let div = document.createElement(\"div\");\n    div.classList.add(\"stage\");\n    this.containers.appendChild(div);\n    return div;\n  }\n\n  /**\n   * 根据舞台对象创建一个canvasStyle\n   * @param stage 舞台对象\n   * @returns\n   */\n  protected getCanvasStylByStage(stage: StageInterface): CanvasStyle {\n    let size = stage.stageSize(this.getContainersSize());\n    let color = stage.stageBackgroundColor(this.getContainersSize());\n    let pos = stage.stagePosition(this.getContainersSize(), size);\n    return { position: pos, color: color, size: size };\n  }\n\n  public refresh() {\n    this.time = Date.now() - this.timeStamp;\n    // 通知每个舞台刷新\n    this.stageList.forEach((stage) => {\n      // console.log(1)\n      stage.refresh(this.time);\n    });\n  }\n\n  /**\n   * 暂停\n   */\n  public pause() {\n    if (!this.pauseStatus) {\n      this.pauseStatus = true;\n    }\n  }\n\n  /**\n   * 播放\n   */\n  public start() {\n    if (this.pauseStatus) {\n      // 同步时间\n      this.timeStamp = Date.now() - this.time;\n      this.pauseStatus = false;\n    }\n  }\n\n  /**\n   * 跳转\n   */\n  public skip(time: number) {\n    if (this.pauseStatus) {\n      // 如果是暂停状态\n      this.time = time;\n    } else {\n      // 否则使用这个方法\n      this.timeStamp = Date.now() - time;\n    }\n  }\n\n  /**\n   * 重置整个系统\n   */\n  public reset() {\n    // 清空所有舞台\n    this.stageList.forEach((stage) => {\n      stage.reset();\n    });\n    // 触发弹幕舞台重置事件\n    DanmakuEvent.dispatch(DanmakuEventType.DANMAKU_STAGE_RESET,{});\n\n    this.pauseStatus = true;\n    this.timeStamp = 0;\n    this.time = 0;\n    this.skipStatus = false;\n  }\n\n  /**\n   * 获取弹幕当前时间\n   * @returns number\n   */\n  public getTime(): number {\n    return this.time;\n  }\n\n  /**\n   * 添加弹幕获取器\n   * @param type\n   * @param fun\n   */\n  public addGetDanmakuFunction(\n    type: string,\n    fun: (send: (str: string[]) => void) => void\n  ) {\n    this.danmakuFunction[type] = fun;\n  }\n\n  /**\n   * 重置弹幕接口\n   */\n  public resetDanmaku(type: number) {\n    // 判断舞台列表是否存在\n    if (!this.stageList[type]) {\n      return;\n    }\n\n    // 弹幕开始加载事件\n    DanmakuEvent.dispatch(DanmakuEventType.DANMAKU_LOAD_START, {});\n    // 获取当前舞台\n    let stage = this.stageList[type];\n    // 获取弹幕时间轴\n    let timeline = stage.getTimeLine();\n    // 重置时间轴\n    timeline.reset();\n    // 根据时间轴类型找到对应的弹幕获取器\n    let fun = this.danmakuFunction[stage.timeLineType()];\n    // 判断弹幕获取器是否存在\n    if (!fun) {\n      return;\n    }\n    fun((res: string[]) => {\n      // 解析弹幕文本\n      let parser = new JsonDanmakuParser();\n      res.forEach((danmakuStr: string) => {\n        // 遍历添加进时间轴\n        parser.parser(danmakuStr).forEach((danmaku) => {\n          timeline.addDanmaku(danmaku);\n        });\n        // 弹幕加载完成事件\n        DanmakuEvent.dispatch(DanmakuEventType.DANMAKU_LOAD_DONE, {});\n      });\n    });\n  }\n}\n","import { UnitInterface } from \"./UnitInterface\"\n\n/**\n * 颜色接口\n */\n\nexport class Color implements UnitInterface {\n    public r: number\n    public g: number\n    public b: number\n    public a: number\n    constructor(r:number, g:number, b:number, a:number) {\n        this.r = r\n        this.g = g\n        this.b = b\n        this.a = a\n    }\n    public string(): string {\n        return \"rgba(\" + this.r + \",\" + this.g + \",\" + this.b + \",\" + this.a + \")\"\n    }\n    /**\n     * 常见颜色表\n     */\n    protected static color:{[key:string]:[number,number,number,number]} = {\n        \"black\":[0,0,0,1],\n        \"white\":[255,255,255,1],\n        \"red\":[255,0,0,1],\n        \"green\":[0,255,0,1],\n        \"blue\":[0,0,255,1],\n        \"pink\":[255,105,108,1],\n        \"yellow\":[255,255,0,1],\n        \"grey\":[130,130,130,1]\n    }\n    /**\n     * 获取预设颜色\n     * @param color 颜色名称\n     * @returns \n     */\n    public static getColor(color:string):Color{\n        if(this.color[color]){\n            return new this(...this.color[color])\n        }else{\n            return new this(...this.color[\"black\"])\n        }\n\n    }\n}","import { RendererInterface } from \"../Renderer/RendererInterface\";\nimport { Color } from \"../Style/Unit/Color\";\nimport { PositionInterface } from \"../Style/PositionInterface\";\nimport { SizeInterface } from \"../Style/SizeInterface\";\nimport { StageInterface } from \"./StageInterface\";\nimport { PxSize } from \"../Style/Unit/PxSize\";\nimport { TimeLineInterface } from \"src/ts/TimeLine/TimeLineInterface\";\nimport { I18n } from \"src/ts/i18n\";\nimport { TimeLineDanmaku } from \"src/ts/TimeLine/TimeLineDanmaku\";\n\nexport abstract class BaseStage implements StageInterface {\n  protected renderer?: RendererInterface;\n  protected timeLineObj?: TimeLineInterface;\n  public stageSize(containersSize: SizeInterface): SizeInterface {\n    return {\n      width: containersSize.width,\n      height: containersSize.height,\n    };\n  }\n  public stagePosition(): PositionInterface {\n    return {\n      x: new PxSize(0),\n      y: new PxSize(0),\n    };\n  }\n  public stageBackgroundColor(): Color {\n    return new Color(0, 0, 0, 0);\n  }\n  public stageRenderer(render: RendererInterface): boolean {\n    this.renderer = render;\n    return true;\n  }\n  public getRenderer(): RendererInterface {\n    if (this.renderer) {\n      return this.renderer;\n    } else {\n      throw ReferenceError(I18n.t(\"renderer is null\"));\n    }\n  }\n  public timeLine(timeLine: TimeLineInterface): boolean {\n    this.timeLineObj = timeLine;\n    return true;\n  }\n  public refresh(time: number): boolean {\n    if (!this.renderer) {\n      return false;\n    }\n    // console.log(time);\n\n    let list: { skip: boolean; DanmakuList: TimeLineDanmaku[] };\n    list = this.timeLineObj?.getDanmakuList(time) || {\n      skip: false,\n      DanmakuList: [],\n    };\n    if (list) {\n      if (list.skip) {\n        this.renderer?.reset();\n      }\n\n      list.DanmakuList.forEach((val) => {\n        this.renderer?.addDanmaku(val.danmaku);\n      });\n    }\n    this.renderer.refresh(time);\n    return true;\n  }\n  public rendererType(): string {\n    return \"css3\";\n  }\n  public timeLineType(): string {\n    return \"advance\";\n  }\n\n  public reset(): boolean {\n    this?.renderer?.reset();\n    return true;\n  }\n  public getTimeLine(): TimeLineInterface {\n    if (!this.timeLineObj) {\n      throw ReferenceError(I18n.t(\"Time line is null\"));\n    }\n    return this.timeLineObj;\n  }\n}\n","\nimport { BaseStage } from \"./BaseStage\";\n\n\nexport class TestStage extends BaseStage{\n\n}","import \"../css/base.css\";\nimport { Controller } from \"./Controller/Controller\";\nimport { I18n } from \"./i18n\";\nimport { InitConfigInterface } from \"./core/InitConfigInterface\";\nimport { TestStage } from \"./core/Stage/TestStage\";\nimport { DanmakuEvent } from \"./Event/DanmakuEvent\";\nimport { DanmakuEventType } from \"./Event/DanmakuEventType\";\nexport class MFADE {\n  public controller: Controller;\n  constructor(config: InitConfigInterface) {\n    // 类型检查\n    if (!config.containers) {\n      throw ReferenceError(I18n.t(\"Containers is null\"));\n    }\n    this.controller = new Controller(config.containers);\n    this.controller.addGetDanmakuFunction(\"advance\", config.danmaku);\n    this.controller.registStage(new TestStage(), 1);\n    this.controller.mount();\n    // 监听大小变化\n    window.addEventListener(\"resize\", () => {\n      this.controller.resize();\n    });\n  }\n\n  /**\n   * 暂停\n   */\n  public pause() {\n    this.controller.pause();\n  }\n  /**\n   * 开始\n   */\n  public start() {\n    this.controller.start();\n  }\n  /**\n   * 跳转\n   */\n  public skip(time: number) {\n    this.controller.skip(time);\n  }\n  /**\n   * 当前时间\n   * @returns number\n   */\n  public time() {\n    return this.controller.getTime();\n  }\n  /**\n   * 重置弹幕尺寸\n   */\n  public resize() {\n    this.controller.resize();\n  }\n  /**\n   * 重置弹幕\n   */\n  public reset() {\n    this.controller.resetDanmaku(1);\n    this.controller.reset();\n  }\n  /**\n   * 添加事件监听\n   * @param event \n   * @param callback \n   */\n  public listenerEvent(event: DanmakuEventType, callback: (data:any) => void) {\n    DanmakuEvent.listener(event, callback);\n  }\n}\n\n// 添加进全局\nif (typeof globalThis !== \"undefined\") {\n  globalThis.MFADE = MFADE;\n} else {\n  window[\"MFADE\"] = MFADE;\n}\n"],"sourceRoot":""}